<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyscf.dft.libxc &mdash; PySCF 1.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="PySCF 1.1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">PySCF 1.1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pyscf.dft.libxc</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python</span>
<span class="c">#</span>
<span class="c"># Author: Qiming Sun &lt;osirpt.sun@gmail.com&gt;</span>
<span class="c">#</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">XC functional, the interface to libxc</span>
<span class="sd">(http://www.tddft.org/programs/octopus/wiki/index.php/Libxc)</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pyscf.lib</span>

<span class="n">_itrf</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">load_library</span><span class="p">(</span><span class="s">&#39;libxc_itrf&#39;</span><span class="p">)</span>

<span class="c"># xc_code from libxc</span>
<span class="n">XC_CODES</span> <span class="o">=</span> <span class="p">{</span>
<span class="s">&#39;XC_LDA_X&#39;</span>                <span class="p">:</span>   <span class="mi">1</span><span class="p">,</span>  <span class="c"># Exchange</span>
<span class="s">&#39;XC_LDA_C_WIGNER&#39;</span>         <span class="p">:</span>   <span class="mi">2</span><span class="p">,</span>  <span class="c"># Wigner parametrization</span>
<span class="s">&#39;XC_LDA_C_RPA&#39;</span>            <span class="p">:</span>   <span class="mi">3</span><span class="p">,</span>  <span class="c"># Random Phase Approximation</span>
<span class="s">&#39;XC_LDA_C_HL&#39;</span>             <span class="p">:</span>   <span class="mi">4</span><span class="p">,</span>  <span class="c"># Hedin &amp; Lundqvist</span>
<span class="s">&#39;XC_LDA_C_GL&#39;</span>             <span class="p">:</span>   <span class="mi">5</span><span class="p">,</span>  <span class="c"># Gunnarson &amp; Lundqvist</span>
<span class="s">&#39;XC_LDA_C_XALPHA&#39;</span>         <span class="p">:</span>   <span class="mi">6</span><span class="p">,</span>  <span class="c"># Slater Xalpha</span>
<span class="s">&#39;XC_LDA_C_VWN&#39;</span>            <span class="p">:</span>   <span class="mi">7</span><span class="p">,</span>  <span class="c"># Vosko, Wilk, &amp; Nussair</span>
<span class="s">&#39;XC_LDA_C_VWNRPA&#39;</span>         <span class="p">:</span>   <span class="mi">8</span><span class="p">,</span>  <span class="c"># Vosko, Wilk, &amp; Nussair (RPA)</span>
<span class="s">&#39;XC_LDA_C_PZ&#39;</span>             <span class="p">:</span>   <span class="mi">9</span><span class="p">,</span>  <span class="c"># Perdew &amp; Zunger</span>
<span class="s">&#39;XC_LDA_C_PZMOD&#39;</span>          <span class="p">:</span>  <span class="mi">10</span><span class="p">,</span>  <span class="c"># Perdew &amp; Zunger (Modified)</span>
<span class="s">&#39;XC_LDA_C_OBPZ&#39;</span>           <span class="p">:</span>  <span class="mi">11</span><span class="p">,</span>  <span class="c"># Ortiz &amp; Ballone (PZ)</span>
<span class="s">&#39;XC_LDA_C_PW&#39;</span>             <span class="p">:</span>  <span class="mi">12</span><span class="p">,</span>  <span class="c"># Perdew &amp; Wang</span>
<span class="s">&#39;XC_LDA_C_PWMOD&#39;</span>          <span class="p">:</span>  <span class="mi">13</span><span class="p">,</span>  <span class="c"># Perdew &amp; Wang (Modified)</span>
<span class="s">&#39;XC_LDA_C_OBPW&#39;</span>           <span class="p">:</span>  <span class="mi">14</span><span class="p">,</span>  <span class="c"># Ortiz &amp; Ballone (PW)</span>
<span class="s">&#39;XC_LDA_C_2DAMGB&#39;</span>         <span class="p">:</span>  <span class="mi">15</span><span class="p">,</span>  <span class="c"># Attacalite et al</span>
<span class="s">&#39;XC_LDA_C_2DPRM&#39;</span>          <span class="p">:</span>  <span class="mi">16</span><span class="p">,</span>  <span class="c"># Pittalis, Rasanen &amp; Marques correlation in 2D</span>
<span class="s">&#39;XC_LDA_C_VBH&#39;</span>            <span class="p">:</span>  <span class="mi">17</span><span class="p">,</span>  <span class="c"># von Barth &amp; Hedin</span>
<span class="s">&#39;XC_LDA_C_1DCSC&#39;</span>          <span class="p">:</span>  <span class="mi">18</span><span class="p">,</span>  <span class="c"># Casula, Sorella, and Senatore 1D correlation</span>
<span class="s">&#39;XC_LDA_X_2D&#39;</span>             <span class="p">:</span>  <span class="mi">19</span><span class="p">,</span>  <span class="c"># Exchange in 2D</span>
<span class="s">&#39;XC_LDA_XC_TETER93&#39;</span>       <span class="p">:</span>  <span class="mi">20</span><span class="p">,</span>  <span class="c"># Teter 93 parametrization</span>
<span class="s">&#39;XC_LDA_X_1D&#39;</span>             <span class="p">:</span>  <span class="mi">21</span><span class="p">,</span>  <span class="c"># Exchange in 1D</span>
<span class="s">&#39;XC_LDA_C_ML1&#39;</span>            <span class="p">:</span>  <span class="mi">22</span><span class="p">,</span>  <span class="c"># Modified LSD (version 1) of Proynov and Salahub</span>
<span class="s">&#39;XC_LDA_C_ML2&#39;</span>            <span class="p">:</span>  <span class="mi">23</span><span class="p">,</span>  <span class="c"># Modified LSD (version 2) of Proynov and Salahub</span>
<span class="s">&#39;XC_LDA_C_GOMBAS&#39;</span>         <span class="p">:</span>  <span class="mi">24</span><span class="p">,</span>  <span class="c"># Gombas parametrization</span>
<span class="s">&#39;XC_LDA_C_PWRPA&#39;</span>          <span class="p">:</span>  <span class="mi">25</span><span class="p">,</span>  <span class="c"># Perdew &amp; Wang fit of the RPA</span>
<span class="s">&#39;XC_LDA_C_1DLOOS&#39;</span>         <span class="p">:</span>  <span class="mi">26</span><span class="p">,</span>  <span class="c"># P-F Loos correlation LDA</span>
<span class="s">&#39;XC_LDA_C_RC04&#39;</span>           <span class="p">:</span>  <span class="mi">27</span><span class="p">,</span>  <span class="c"># Ragot-Cortona</span>
<span class="s">&#39;XC_LDA_C_VWN1&#39;</span>           <span class="p">:</span>  <span class="mi">28</span><span class="p">,</span>  <span class="c"># Vosko, Wilk, &amp; Nussair (1)</span>
<span class="s">&#39;XC_LDA_C_VWN2&#39;</span>           <span class="p">:</span>  <span class="mi">29</span><span class="p">,</span>  <span class="c"># Vosko, Wilk, &amp; Nussair (2)</span>
<span class="s">&#39;XC_LDA_C_VWN3&#39;</span>           <span class="p">:</span>  <span class="mi">30</span><span class="p">,</span>  <span class="c"># Vosko, Wilk, &amp; Nussair (3)</span>
<span class="s">&#39;XC_LDA_C_VWN4&#39;</span>           <span class="p">:</span>  <span class="mi">31</span><span class="p">,</span>  <span class="c"># Vosko, Wilk, &amp; Nussair (4)</span>
<span class="s">&#39;XC_LDA_K_TF&#39;</span>             <span class="p">:</span>  <span class="mi">50</span><span class="p">,</span>  <span class="c"># Thomas-Fermi kinetic energy functional</span>
<span class="s">&#39;XC_LDA_K_LP&#39;</span>             <span class="p">:</span>  <span class="mi">51</span><span class="p">,</span>  <span class="c"># Lee and Parr Gaussian ansatz</span>
<span class="s">&#39;XC_GGA_C_Q2D&#39;</span>            <span class="p">:</span>  <span class="mi">47</span><span class="p">,</span>  <span class="c"># Chiodo et al</span>
<span class="s">&#39;XC_GGA_X_Q2D&#39;</span>            <span class="p">:</span>  <span class="mi">48</span><span class="p">,</span>  <span class="c"># Chiodo et al</span>
<span class="s">&#39;XC_GGA_X_PBEMOL&#39;</span>         <span class="p">:</span>  <span class="mi">49</span><span class="p">,</span>  <span class="c"># Del Campo, Gazquez, Trickey and Vela (PBE-like)</span>
<span class="s">&#39;XC_GGA_K_TFVW&#39;</span>           <span class="p">:</span>  <span class="mi">52</span><span class="p">,</span>  <span class="c"># Thomas-Fermi plus von Weiszaecker correction</span>
<span class="s">&#39;XC_GGA_K_REVAPBEINT&#39;</span>     <span class="p">:</span>  <span class="mi">53</span><span class="p">,</span>  <span class="c"># interpolated version of REVAPBE</span>
<span class="s">&#39;XC_GGA_K_APBEINT&#39;</span>        <span class="p">:</span>  <span class="mi">54</span><span class="p">,</span>  <span class="c"># interpolated version of APBE</span>
<span class="s">&#39;XC_GGA_K_REVAPBE&#39;</span>        <span class="p">:</span>  <span class="mi">55</span><span class="p">,</span>  <span class="c"># revised APBE</span>
<span class="s">&#39;XC_GGA_X_AK13&#39;</span>           <span class="p">:</span>  <span class="mi">56</span><span class="p">,</span>  <span class="c"># Armiento &amp; Kuemmel 2013</span>
<span class="s">&#39;XC_GGA_K_MEYER&#39;</span>          <span class="p">:</span>  <span class="mi">57</span><span class="p">,</span>  <span class="c"># Meyer,  Wang, and Young</span>
<span class="s">&#39;XC_GGA_X_LVRPW86&#39;</span>        <span class="p">:</span>  <span class="mi">58</span><span class="p">,</span>  <span class="c"># Berland and Hyldgaard</span>
<span class="s">&#39;XC_GGA_X_PBETCA&#39;</span>         <span class="p">:</span>  <span class="mi">59</span><span class="p">,</span>  <span class="c"># PBE revised by Tognetti et al</span>
<span class="s">&#39;XC_GGA_X_PBEINT&#39;</span>         <span class="p">:</span>  <span class="mi">60</span><span class="p">,</span>  <span class="c"># PBE for hybrid interfaces</span>
<span class="s">&#39;XC_GGA_C_ZPBEINT&#39;</span>        <span class="p">:</span>  <span class="mi">61</span><span class="p">,</span>  <span class="c"># spin-dependent gradient correction to PBEint</span>
<span class="s">&#39;XC_GGA_C_PBEINT&#39;</span>         <span class="p">:</span>  <span class="mi">62</span><span class="p">,</span>  <span class="c"># PBE for hybrid interfaces</span>
<span class="s">&#39;XC_GGA_C_ZPBESOL&#39;</span>        <span class="p">:</span>  <span class="mi">63</span><span class="p">,</span>  <span class="c"># spin-dependent gradient correction to PBEsol</span>
<span class="s">&#39;XC_GGA_XC_OPBED&#39;</span>         <span class="p">:</span>  <span class="mi">65</span><span class="p">,</span>  <span class="c"># oPBE_D functional of Goerigk and Grimme</span>
<span class="s">&#39;XC_GGA_XC_OPWLYPD&#39;</span>       <span class="p">:</span>  <span class="mi">66</span><span class="p">,</span>  <span class="c"># oPWLYP-D functional of Goerigk and Grimme</span>
<span class="s">&#39;XC_GGA_XC_OBLYPD&#39;</span>        <span class="p">:</span>  <span class="mi">67</span><span class="p">,</span>  <span class="c"># oBLYP-D functional of Goerigk and Grimme</span>
<span class="s">&#39;XC_GGA_X_VMT84GE&#39;</span>        <span class="p">:</span>  <span class="mi">68</span><span class="p">,</span>  <span class="c"># VMT{8,4} with constraint satisfaction with mu = mu_GE</span>
<span class="s">&#39;XC_GGA_X_VMT84PBE&#39;</span>       <span class="p">:</span>  <span class="mi">69</span><span class="p">,</span>  <span class="c"># VMT{8,4} with constraint satisfaction with mu = mu_PBE</span>
<span class="s">&#39;XC_GGA_X_VMTGE&#39;</span>          <span class="p">:</span>  <span class="mi">70</span><span class="p">,</span>  <span class="c"># Vela, Medel, and Trickey with mu = mu_GE</span>
<span class="s">&#39;XC_GGA_X_VMTPBE&#39;</span>         <span class="p">:</span>  <span class="mi">71</span><span class="p">,</span>  <span class="c"># Vela, Medel, and Trickey with mu = mu_PBE</span>
<span class="s">&#39;XC_GGA_C_N12SX&#39;</span>          <span class="p">:</span>  <span class="mi">79</span><span class="p">,</span>  <span class="c"># N12-SX functional from Minnesota</span>
<span class="s">&#39;XC_GGA_C_N12&#39;</span>            <span class="p">:</span>  <span class="mi">80</span><span class="p">,</span>  <span class="c"># N12 functional from Minnesota</span>
<span class="s">&#39;XC_GGA_X_N12&#39;</span>            <span class="p">:</span>  <span class="mi">82</span><span class="p">,</span>  <span class="c"># N12 functional from Minnesota</span>
<span class="s">&#39;XC_GGA_C_VPBE&#39;</span>           <span class="p">:</span>  <span class="mi">83</span><span class="p">,</span>  <span class="c"># variant PBE</span>
<span class="s">&#39;XC_GGA_C_OPXALPHA&#39;</span>       <span class="p">:</span>  <span class="mi">84</span><span class="p">,</span>  <span class="c"># one-parameter progressive functional (XALPHA version)</span>
<span class="s">&#39;XC_GGA_C_OPG96&#39;</span>          <span class="p">:</span>  <span class="mi">85</span><span class="p">,</span>  <span class="c"># one-parameter progressive functional (G96 version)</span>
<span class="s">&#39;XC_GGA_C_OPPBE&#39;</span>          <span class="p">:</span>  <span class="mi">86</span><span class="p">,</span>  <span class="c"># one-parameter progressive functional (PBE version)</span>
<span class="s">&#39;XC_GGA_C_OPB88&#39;</span>          <span class="p">:</span>  <span class="mi">87</span><span class="p">,</span>  <span class="c"># one-parameter progressive functional (B88 version)</span>
<span class="s">&#39;XC_GGA_C_FT97&#39;</span>           <span class="p">:</span>  <span class="mi">88</span><span class="p">,</span>  <span class="c"># Filatov &amp; Thiel correlation</span>
<span class="s">&#39;XC_GGA_C_SPBE&#39;</span>           <span class="p">:</span>  <span class="mi">89</span><span class="p">,</span>  <span class="c"># PBE correlation to be used with the SSB exchange</span>
<span class="s">&#39;XC_GGA_X_SSBSW&#39;</span>          <span class="p">:</span>  <span class="mi">90</span><span class="p">,</span>  <span class="c"># Swarta, Sola and Bickelhaupt correction to PBE</span>
<span class="s">&#39;XC_GGA_X_SSB&#39;</span>            <span class="p">:</span>  <span class="mi">91</span><span class="p">,</span>  <span class="c"># Swarta, Sola and Bickelhaupt</span>
<span class="s">&#39;XC_GGA_X_SSBD&#39;</span>           <span class="p">:</span>  <span class="mi">92</span><span class="p">,</span>  <span class="c"># Swarta, Sola and Bickelhaupt dispersion</span>
<span class="s">&#39;XC_GGA_XC_HCTH407P&#39;</span>      <span class="p">:</span>  <span class="mi">93</span><span class="p">,</span>  <span class="c"># HCTH/407+</span>
<span class="s">&#39;XC_GGA_XC_HCTHP76&#39;</span>       <span class="p">:</span>  <span class="mi">94</span><span class="p">,</span>  <span class="c"># HCTH p=7/6</span>
<span class="s">&#39;XC_GGA_XC_HCTHP14&#39;</span>       <span class="p">:</span>  <span class="mi">95</span><span class="p">,</span>  <span class="c"># HCTH p=1/4</span>
<span class="s">&#39;XC_GGA_XC_B97GGA1&#39;</span>       <span class="p">:</span>  <span class="mi">96</span><span class="p">,</span>  <span class="c"># Becke 97 GGA-1</span>
<span class="s">&#39;XC_GGA_XC_HCTHA&#39;</span>         <span class="p">:</span>  <span class="mi">97</span><span class="p">,</span>  <span class="c"># HCTH-A</span>
<span class="s">&#39;XC_GGA_X_BPCCAC&#39;</span>         <span class="p">:</span>  <span class="mi">98</span><span class="p">,</span>  <span class="c"># BPCCAC (GRAC for the energy)</span>
<span class="s">&#39;XC_GGA_C_REVTCA&#39;</span>         <span class="p">:</span>  <span class="mi">99</span><span class="p">,</span>  <span class="c"># Tognetti, Cortona, Adamo (revised)</span>
<span class="s">&#39;XC_GGA_C_TCA&#39;</span>            <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c"># Tognetti, Cortona, Adamo</span>
<span class="s">&#39;XC_GGA_X_PBE&#39;</span>            <span class="p">:</span> <span class="mi">101</span><span class="p">,</span>  <span class="c"># Perdew, Burke &amp; Ernzerhof exchange</span>
<span class="s">&#39;XC_GGA_X_PBER&#39;</span>           <span class="p">:</span> <span class="mi">102</span><span class="p">,</span>  <span class="c"># Perdew, Burke &amp; Ernzerhof exchange (revised)</span>
<span class="s">&#39;XC_GGA_X_B86&#39;</span>            <span class="p">:</span> <span class="mi">103</span><span class="p">,</span>  <span class="c"># Becke 86 Xalfa,beta,gamma</span>
<span class="s">&#39;XC_GGA_X_HERMAN&#39;</span>         <span class="p">:</span> <span class="mi">104</span><span class="p">,</span>  <span class="c"># Herman et al original GGA</span>
<span class="s">&#39;XC_GGA_X_B86MGC&#39;</span>         <span class="p">:</span> <span class="mi">105</span><span class="p">,</span>  <span class="c"># Becke 86 Xalfa,beta,gamma (with mod. grad. correction)</span>
<span class="s">&#39;XC_GGA_X_B88&#39;</span>            <span class="p">:</span> <span class="mi">106</span><span class="p">,</span>  <span class="c"># Becke 88</span>
<span class="s">&#39;XC_GGA_X_G96&#39;</span>            <span class="p">:</span> <span class="mi">107</span><span class="p">,</span>  <span class="c"># Gill 96</span>
<span class="s">&#39;XC_GGA_X_PW86&#39;</span>           <span class="p">:</span> <span class="mi">108</span><span class="p">,</span>  <span class="c"># Perdew &amp; Wang 86</span>
<span class="s">&#39;XC_GGA_X_PW91&#39;</span>           <span class="p">:</span> <span class="mi">109</span><span class="p">,</span>  <span class="c"># Perdew &amp; Wang 91</span>
<span class="s">&#39;XC_GGA_X_OPTX&#39;</span>           <span class="p">:</span> <span class="mi">110</span><span class="p">,</span>  <span class="c"># Handy &amp; Cohen OPTX 01</span>
<span class="s">&#39;XC_GGA_X_DK87R1&#39;</span>         <span class="p">:</span> <span class="mi">111</span><span class="p">,</span>  <span class="c"># dePristo &amp; Kress 87 (version R1)</span>
<span class="s">&#39;XC_GGA_X_DK87R2&#39;</span>         <span class="p">:</span> <span class="mi">112</span><span class="p">,</span>  <span class="c"># dePristo &amp; Kress 87 (version R2)</span>
<span class="s">&#39;XC_GGA_X_LG93&#39;</span>           <span class="p">:</span> <span class="mi">113</span><span class="p">,</span>  <span class="c"># Lacks &amp; Gordon 93</span>
<span class="s">&#39;XC_GGA_X_FT97A&#39;</span>          <span class="p">:</span> <span class="mi">114</span><span class="p">,</span>  <span class="c"># Filatov &amp; Thiel 97 (version A)</span>
<span class="s">&#39;XC_GGA_X_FT97B&#39;</span>          <span class="p">:</span> <span class="mi">115</span><span class="p">,</span>  <span class="c"># Filatov &amp; Thiel 97 (version B)</span>
<span class="s">&#39;XC_GGA_X_PBESOL&#39;</span>         <span class="p">:</span> <span class="mi">116</span><span class="p">,</span>  <span class="c"># Perdew, Burke &amp; Ernzerhof exchange (solids)</span>
<span class="s">&#39;XC_GGA_X_RPBE&#39;</span>           <span class="p">:</span> <span class="mi">117</span><span class="p">,</span>  <span class="c"># Hammer, Hansen &amp; Norskov (PBE-like)</span>
<span class="s">&#39;XC_GGA_X_WC&#39;</span>             <span class="p">:</span> <span class="mi">118</span><span class="p">,</span>  <span class="c"># Wu &amp; Cohen</span>
<span class="s">&#39;XC_GGA_X_MPW91&#39;</span>          <span class="p">:</span> <span class="mi">119</span><span class="p">,</span>  <span class="c"># Modified form of PW91 by Adamo &amp; Barone</span>
<span class="s">&#39;XC_GGA_X_AM05&#39;</span>           <span class="p">:</span> <span class="mi">120</span><span class="p">,</span>  <span class="c"># Armiento &amp; Mattsson 05 exchange</span>
<span class="s">&#39;XC_GGA_X_PBEA&#39;</span>           <span class="p">:</span> <span class="mi">121</span><span class="p">,</span>  <span class="c"># Madsen (PBE-like)</span>
<span class="s">&#39;XC_GGA_X_MPBE&#39;</span>           <span class="p">:</span> <span class="mi">122</span><span class="p">,</span>  <span class="c"># Adamo &amp; Barone modification to PBE</span>
<span class="s">&#39;XC_GGA_X_XPBE&#39;</span>           <span class="p">:</span> <span class="mi">123</span><span class="p">,</span>  <span class="c"># xPBE reparametrization by Xu &amp; Goddard</span>
<span class="s">&#39;XC_GGA_X_2DB86MGC&#39;</span>       <span class="p">:</span> <span class="mi">124</span><span class="p">,</span>  <span class="c"># Becke 86 MGC for 2D systems</span>
<span class="s">&#39;XC_GGA_X_BAYESIAN&#39;</span>       <span class="p">:</span> <span class="mi">125</span><span class="p">,</span>  <span class="c"># Bayesian best fit for the enhancement factor</span>
<span class="s">&#39;XC_GGA_X_PBEJSJR&#39;</span>        <span class="p">:</span> <span class="mi">126</span><span class="p">,</span>  <span class="c"># JSJR reparametrization by Pedroza, Silva &amp; Capelle</span>
<span class="s">&#39;XC_GGA_X_2DB88&#39;</span>          <span class="p">:</span> <span class="mi">127</span><span class="p">,</span>  <span class="c"># Becke 88 in 2D</span>
<span class="s">&#39;XC_GGA_X_2DB86&#39;</span>          <span class="p">:</span> <span class="mi">128</span><span class="p">,</span>  <span class="c"># Becke 86 Xalfa,beta,gamma</span>
<span class="s">&#39;XC_GGA_X_2DPBE&#39;</span>          <span class="p">:</span> <span class="mi">129</span><span class="p">,</span>  <span class="c"># Perdew, Burke &amp; Ernzerhof exchange in 2D</span>
<span class="s">&#39;XC_GGA_C_PBE&#39;</span>            <span class="p">:</span> <span class="mi">130</span><span class="p">,</span>  <span class="c"># Perdew, Burke &amp; Ernzerhof correlation</span>
<span class="s">&#39;XC_GGA_C_LYP&#39;</span>            <span class="p">:</span> <span class="mi">131</span><span class="p">,</span>  <span class="c"># Lee, Yang &amp; Parr</span>
<span class="s">&#39;XC_GGA_C_P86&#39;</span>            <span class="p">:</span> <span class="mi">132</span><span class="p">,</span>  <span class="c"># Perdew 86</span>
<span class="s">&#39;XC_GGA_C_PBESOL&#39;</span>         <span class="p">:</span> <span class="mi">133</span><span class="p">,</span>  <span class="c"># Perdew, Burke &amp; Ernzerhof correlation SOL</span>
<span class="s">&#39;XC_GGA_C_PW91&#39;</span>           <span class="p">:</span> <span class="mi">134</span><span class="p">,</span>  <span class="c"># Perdew &amp; Wang 91</span>
<span class="s">&#39;XC_GGA_C_AM05&#39;</span>           <span class="p">:</span> <span class="mi">135</span><span class="p">,</span>  <span class="c"># Armiento &amp; Mattsson 05 correlation</span>
<span class="s">&#39;XC_GGA_C_XPBE&#39;</span>           <span class="p">:</span> <span class="mi">136</span><span class="p">,</span>  <span class="c"># xPBE reparametrization by Xu &amp; Goddard</span>
<span class="s">&#39;XC_GGA_C_LM&#39;</span>             <span class="p">:</span> <span class="mi">137</span><span class="p">,</span>  <span class="c"># Langreth and Mehl correlation</span>
<span class="s">&#39;XC_GGA_C_PBEJRGX&#39;</span>        <span class="p">:</span> <span class="mi">138</span><span class="p">,</span>  <span class="c"># JRGX reparametrization by Pedroza, Silva &amp; Capelle</span>
<span class="s">&#39;XC_GGA_X_OPTB88VDW&#39;</span>      <span class="p">:</span> <span class="mi">139</span><span class="p">,</span>  <span class="c"># Becke 88 reoptimized to be used with vdW functional of Dion et al</span>
<span class="s">&#39;XC_GGA_X_PBEK1VDW&#39;</span>       <span class="p">:</span> <span class="mi">140</span><span class="p">,</span>  <span class="c"># PBE reparametrization for vdW</span>
<span class="s">&#39;XC_GGA_X_OPTPBEVDW&#39;</span>      <span class="p">:</span> <span class="mi">141</span><span class="p">,</span>  <span class="c"># PBE reparametrization for vdW</span>
<span class="s">&#39;XC_GGA_X_RGE2&#39;</span>           <span class="p">:</span> <span class="mi">142</span><span class="p">,</span>  <span class="c"># Regularized PBE</span>
<span class="s">&#39;XC_GGA_C_RGE2&#39;</span>           <span class="p">:</span> <span class="mi">143</span><span class="p">,</span>  <span class="c"># Regularized PBE</span>
<span class="s">&#39;XC_GGA_X_RPW86&#39;</span>          <span class="p">:</span> <span class="mi">144</span><span class="p">,</span>  <span class="c"># refitted Perdew &amp; Wang 86</span>
<span class="s">&#39;XC_GGA_X_KT1&#39;</span>            <span class="p">:</span> <span class="mi">145</span><span class="p">,</span>  <span class="c"># Keal and Tozer version 1</span>
<span class="s">&#39;XC_GGA_XC_KT2&#39;</span>           <span class="p">:</span> <span class="mi">146</span><span class="p">,</span>  <span class="c"># Keal and Tozer version 2</span>
<span class="s">&#39;XC_GGA_C_WL&#39;</span>             <span class="p">:</span> <span class="mi">147</span><span class="p">,</span>  <span class="c"># Wilson &amp; Levy</span>
<span class="s">&#39;XC_GGA_C_WI&#39;</span>             <span class="p">:</span> <span class="mi">148</span><span class="p">,</span>  <span class="c"># Wilson &amp; Ivanov</span>
<span class="s">&#39;XC_GGA_X_MB88&#39;</span>           <span class="p">:</span> <span class="mi">149</span><span class="p">,</span>  <span class="c"># Modified Becke 88 for proton transfer</span>
<span class="s">&#39;XC_GGA_X_SOGGA&#39;</span>          <span class="p">:</span> <span class="mi">150</span><span class="p">,</span>  <span class="c"># Second-order generalized gradient approximation</span>
<span class="s">&#39;XC_GGA_X_SOGGA11&#39;</span>        <span class="p">:</span> <span class="mi">151</span><span class="p">,</span>  <span class="c"># Second-order generalized gradient approximation 2011</span>
<span class="s">&#39;XC_GGA_C_SOGGA11&#39;</span>        <span class="p">:</span> <span class="mi">152</span><span class="p">,</span>  <span class="c"># Second-order generalized gradient approximation 2011</span>
<span class="s">&#39;XC_GGA_C_WI0&#39;</span>            <span class="p">:</span> <span class="mi">153</span><span class="p">,</span>  <span class="c"># Wilson &amp; Ivanov initial version</span>
<span class="s">&#39;XC_GGA_XC_TH1&#39;</span>           <span class="p">:</span> <span class="mi">154</span><span class="p">,</span>  <span class="c"># Tozer and Handy v. 1</span>
<span class="s">&#39;XC_GGA_XC_TH2&#39;</span>           <span class="p">:</span> <span class="mi">155</span><span class="p">,</span>  <span class="c"># Tozer and Handy v. 2</span>
<span class="s">&#39;XC_GGA_XC_TH3&#39;</span>           <span class="p">:</span> <span class="mi">156</span><span class="p">,</span>  <span class="c"># Tozer and Handy v. 3</span>
<span class="s">&#39;XC_GGA_XC_TH4&#39;</span>           <span class="p">:</span> <span class="mi">157</span><span class="p">,</span>  <span class="c"># Tozer and Handy v. 4</span>
<span class="s">&#39;XC_GGA_X_C09X&#39;</span>           <span class="p">:</span> <span class="mi">158</span><span class="p">,</span>  <span class="c"># C09x to be used with the VdW of Rutgers-Chalmers</span>
<span class="s">&#39;XC_GGA_C_SOGGA11X&#39;</span>       <span class="p">:</span> <span class="mi">159</span><span class="p">,</span>  <span class="c"># To be used with hyb_gga_x_SOGGA11-X</span>
<span class="s">&#39;XC_GGA_X_LB&#39;</span>             <span class="p">:</span> <span class="mi">160</span><span class="p">,</span>  <span class="c"># van Leeuwen &amp; Baerends</span>
<span class="s">&#39;XC_GGA_XC_HCTH93&#39;</span>        <span class="p">:</span> <span class="mi">161</span><span class="p">,</span>  <span class="c"># HCTH functional fitted to  93 molecules</span>
<span class="s">&#39;XC_GGA_XC_HCTH120&#39;</span>       <span class="p">:</span> <span class="mi">162</span><span class="p">,</span>  <span class="c"># HCTH functional fitted to 120 molecules</span>
<span class="s">&#39;XC_GGA_XC_HCTH147&#39;</span>       <span class="p">:</span> <span class="mi">163</span><span class="p">,</span>  <span class="c"># HCTH functional fitted to 147 molecules</span>
<span class="s">&#39;XC_GGA_XC_HCTH407&#39;</span>       <span class="p">:</span> <span class="mi">164</span><span class="p">,</span>  <span class="c"># HCTH functional fitted to 407 molecules</span>
<span class="s">&#39;XC_GGA_XC_EDF1&#39;</span>          <span class="p">:</span> <span class="mi">165</span><span class="p">,</span>  <span class="c"># Empirical functionals from Adamson, Gill, and Pople</span>
<span class="s">&#39;XC_GGA_XC_XLYP&#39;</span>          <span class="p">:</span> <span class="mi">166</span><span class="p">,</span>  <span class="c"># XLYP functional</span>
<span class="s">&#39;XC_GGA_XC_B97&#39;</span>           <span class="p">:</span> <span class="mi">167</span><span class="p">,</span>  <span class="c"># Becke 97</span>
<span class="s">&#39;XC_GGA_XC_B971&#39;</span>          <span class="p">:</span> <span class="mi">168</span><span class="p">,</span>  <span class="c"># Becke 97-1</span>
<span class="s">&#39;XC_GGA_XC_B972&#39;</span>          <span class="p">:</span> <span class="mi">169</span><span class="p">,</span>  <span class="c"># Becke 97-2</span>
<span class="s">&#39;XC_GGA_XC_B97D&#39;</span>          <span class="p">:</span> <span class="mi">170</span><span class="p">,</span>  <span class="c"># Grimme functional to be used with C6 vdW term</span>
<span class="s">&#39;XC_GGA_XC_B97K&#39;</span>          <span class="p">:</span> <span class="mi">171</span><span class="p">,</span>  <span class="c"># Boese-Martin for Kinetics</span>
<span class="s">&#39;XC_GGA_XC_B973&#39;</span>          <span class="p">:</span> <span class="mi">172</span><span class="p">,</span>  <span class="c"># Becke 97-3</span>
<span class="s">&#39;XC_GGA_XC_PBE1W&#39;</span>         <span class="p">:</span> <span class="mi">173</span><span class="p">,</span>  <span class="c"># Functionals fitted for water</span>
<span class="s">&#39;XC_GGA_XC_MPWLYP1W&#39;</span>      <span class="p">:</span> <span class="mi">174</span><span class="p">,</span>  <span class="c"># Functionals fitted for water</span>
<span class="s">&#39;XC_GGA_XC_PBELYP1W&#39;</span>      <span class="p">:</span> <span class="mi">175</span><span class="p">,</span>  <span class="c"># Functionals fitted for water</span>
<span class="s">&#39;XC_GGA_XC_SB981A&#39;</span>        <span class="p">:</span> <span class="mi">176</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 1a</span>
<span class="s">&#39;XC_GGA_XC_SB981B&#39;</span>        <span class="p">:</span> <span class="mi">177</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 1b</span>
<span class="s">&#39;XC_GGA_XC_SB981C&#39;</span>        <span class="p">:</span> <span class="mi">178</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 1c</span>
<span class="s">&#39;XC_GGA_XC_SB982A&#39;</span>        <span class="p">:</span> <span class="mi">179</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 2a</span>
<span class="s">&#39;XC_GGA_XC_SB982B&#39;</span>        <span class="p">:</span> <span class="mi">180</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 2b</span>
<span class="s">&#39;XC_GGA_XC_SB982C&#39;</span>        <span class="p">:</span> <span class="mi">181</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 2c</span>
<span class="s">&#39;XC_GGA_X_LBM&#39;</span>            <span class="p">:</span> <span class="mi">182</span><span class="p">,</span>  <span class="c"># van Leeuwen &amp; Baerends modified</span>
<span class="s">&#39;XC_GGA_X_OL2&#39;</span>            <span class="p">:</span> <span class="mi">183</span><span class="p">,</span>  <span class="c"># Exchange form based on Ou-Yang and Levy v.2</span>
<span class="s">&#39;XC_GGA_X_APBE&#39;</span>           <span class="p">:</span> <span class="mi">184</span><span class="p">,</span>  <span class="c"># mu fixed from the semiclassical neutral atom</span>
<span class="s">&#39;XC_GGA_K_APBE&#39;</span>           <span class="p">:</span> <span class="mi">185</span><span class="p">,</span>  <span class="c"># mu fixed from the semiclassical neutral atom</span>
<span class="s">&#39;XC_GGA_C_APBE&#39;</span>           <span class="p">:</span> <span class="mi">186</span><span class="p">,</span>  <span class="c"># mu fixed from the semiclassical neutral atom</span>
<span class="s">&#39;XC_GGA_K_TW1&#39;</span>            <span class="p">:</span> <span class="mi">187</span><span class="p">,</span>  <span class="c"># Tran and Wesolowski set 1 (Table II)</span>
<span class="s">&#39;XC_GGA_K_TW2&#39;</span>            <span class="p">:</span> <span class="mi">188</span><span class="p">,</span>  <span class="c"># Tran and Wesolowski set 2 (Table II)</span>
<span class="s">&#39;XC_GGA_K_TW3&#39;</span>            <span class="p">:</span> <span class="mi">189</span><span class="p">,</span>  <span class="c"># Tran and Wesolowski set 3 (Table II)</span>
<span class="s">&#39;XC_GGA_K_TW4&#39;</span>            <span class="p">:</span> <span class="mi">190</span><span class="p">,</span>  <span class="c"># Tran and Wesolowski set 4 (Table II)</span>
<span class="s">&#39;XC_GGA_X_HTBS&#39;</span>           <span class="p">:</span> <span class="mi">191</span><span class="p">,</span>  <span class="c"># Haas, Tran, Blaha, and Schwarz</span>
<span class="s">&#39;XC_GGA_X_AIRY&#39;</span>           <span class="p">:</span> <span class="mi">192</span><span class="p">,</span>  <span class="c"># Constantin et al based on the Airy gas</span>
<span class="s">&#39;XC_GGA_X_LAG&#39;</span>            <span class="p">:</span> <span class="mi">193</span><span class="p">,</span>  <span class="c"># Local Airy Gas</span>
<span class="s">&#39;XC_GGA_XC_MOHLYP&#39;</span>        <span class="p">:</span> <span class="mi">194</span><span class="p">,</span>  <span class="c"># Functional for organometallic chemistry</span>
<span class="s">&#39;XC_GGA_XC_MOHLYP2&#39;</span>       <span class="p">:</span> <span class="mi">195</span><span class="p">,</span>  <span class="c"># Functional for barrier heights</span>
<span class="s">&#39;XC_GGA_XC_THFL&#39;</span>          <span class="p">:</span> <span class="mi">196</span><span class="p">,</span>  <span class="c"># Tozer and Handy v. FL</span>
<span class="s">&#39;XC_GGA_XC_THFC&#39;</span>          <span class="p">:</span> <span class="mi">197</span><span class="p">,</span>  <span class="c"># Tozer and Handy v. FC</span>
<span class="s">&#39;XC_GGA_XC_THFCFO&#39;</span>        <span class="p">:</span> <span class="mi">198</span><span class="p">,</span>  <span class="c"># Tozer and Handy v. FCFO</span>
<span class="s">&#39;XC_GGA_XC_THFCO&#39;</span>         <span class="p">:</span> <span class="mi">199</span><span class="p">,</span>  <span class="c"># Tozer and Handy v. FCO</span>
<span class="s">&#39;XC_GGA_C_OPTC&#39;</span>           <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>  <span class="c"># Optimized correlation functional of Cohen and Handy</span>
<span class="s">&#39;XC_GGA_K_VW&#39;</span>             <span class="p">:</span> <span class="mi">500</span><span class="p">,</span>  <span class="c"># von Weiszaecker functional</span>
<span class="s">&#39;XC_GGA_K_GE2&#39;</span>            <span class="p">:</span> <span class="mi">501</span><span class="p">,</span>  <span class="c"># Second-order gradient expansion (l = 1/9)</span>
<span class="s">&#39;XC_GGA_K_GOLDEN&#39;</span>         <span class="p">:</span> <span class="mi">502</span><span class="p">,</span>  <span class="c"># TF-lambda-vW form by Golden (l = 13/45)</span>
<span class="s">&#39;XC_GGA_K_YT65&#39;</span>           <span class="p">:</span> <span class="mi">503</span><span class="p">,</span>  <span class="c"># TF-lambda-vW form by Yonei and Tomishima (l = 1/5)</span>
<span class="s">&#39;XC_GGA_K_BALTIN&#39;</span>         <span class="p">:</span> <span class="mi">504</span><span class="p">,</span>  <span class="c"># TF-lambda-vW form by Baltin (l = 5/9)</span>
<span class="s">&#39;XC_GGA_K_LIEB&#39;</span>           <span class="p">:</span> <span class="mi">505</span><span class="p">,</span>  <span class="c"># TF-lambda-vW form by Lieb (l = 0.185909191)</span>
<span class="s">&#39;XC_GGA_K_ABSP1&#39;</span>          <span class="p">:</span> <span class="mi">506</span><span class="p">,</span>  <span class="c"># gamma-TFvW form by Acharya et al [g = 1 - 1.412/N^(1/3)]</span>
<span class="s">&#39;XC_GGA_K_ABSP2&#39;</span>          <span class="p">:</span> <span class="mi">507</span><span class="p">,</span>  <span class="c"># gamma-TFvW form by Acharya et al [g = 1 - 1.332/N^(1/3)]</span>
<span class="s">&#39;XC_GGA_K_GR&#39;</span>             <span class="p">:</span> <span class="mi">508</span><span class="p">,</span>  <span class="c"># gamma-TFvW form by Gazquez and Robles</span>
<span class="s">&#39;XC_GGA_K_LUDENA&#39;</span>         <span class="p">:</span> <span class="mi">509</span><span class="p">,</span>  <span class="c"># gamma-TFvW form by Ludena</span>
<span class="s">&#39;XC_GGA_K_GP85&#39;</span>           <span class="p">:</span> <span class="mi">510</span><span class="p">,</span>  <span class="c"># gamma-TFvW form by Ghosh and Parr</span>
<span class="s">&#39;XC_GGA_K_PEARSON&#39;</span>        <span class="p">:</span> <span class="mi">511</span><span class="p">,</span>  <span class="c"># Pearson</span>
<span class="s">&#39;XC_GGA_K_OL1&#39;</span>            <span class="p">:</span> <span class="mi">512</span><span class="p">,</span>  <span class="c"># Ou-Yang and Levy v.1</span>
<span class="s">&#39;XC_GGA_K_OL2&#39;</span>            <span class="p">:</span> <span class="mi">513</span><span class="p">,</span>  <span class="c"># Ou-Yang and Levy v.2</span>
<span class="s">&#39;XC_GGA_K_FRB88&#39;</span>          <span class="p">:</span> <span class="mi">514</span><span class="p">,</span>  <span class="c"># Fuentealba &amp; Reyes (B88 version)</span>
<span class="s">&#39;XC_GGA_K_FRPW86&#39;</span>         <span class="p">:</span> <span class="mi">515</span><span class="p">,</span>  <span class="c"># Fuentealba &amp; Reyes (PW86 version)</span>
<span class="s">&#39;XC_GGA_K_DK&#39;</span>             <span class="p">:</span> <span class="mi">516</span><span class="p">,</span>  <span class="c"># DePristo and Kress</span>
<span class="s">&#39;XC_GGA_K_PERDEW&#39;</span>         <span class="p">:</span> <span class="mi">517</span><span class="p">,</span>  <span class="c"># Perdew</span>
<span class="s">&#39;XC_GGA_K_VSK&#39;</span>            <span class="p">:</span> <span class="mi">518</span><span class="p">,</span>  <span class="c"># Vitos, Skriver, and Kollar</span>
<span class="s">&#39;XC_GGA_K_VJKS&#39;</span>           <span class="p">:</span> <span class="mi">519</span><span class="p">,</span>  <span class="c"># Vitos, Johansson, Kollar, and Skriver</span>
<span class="s">&#39;XC_GGA_K_ERNZERHOF&#39;</span>      <span class="p">:</span> <span class="mi">520</span><span class="p">,</span>  <span class="c"># Ernzerhof</span>
<span class="s">&#39;XC_GGA_K_LC94&#39;</span>           <span class="p">:</span> <span class="mi">521</span><span class="p">,</span>  <span class="c"># Lembarki &amp; Chermette</span>
<span class="s">&#39;XC_GGA_K_LLP&#39;</span>            <span class="p">:</span> <span class="mi">522</span><span class="p">,</span>  <span class="c"># Lee, Lee &amp; Parr</span>
<span class="s">&#39;XC_GGA_K_THAKKAR&#39;</span>        <span class="p">:</span> <span class="mi">523</span><span class="p">,</span>  <span class="c"># Thakkar 1992</span>
<span class="s">&#39;XC_GGA_X_WPBEH&#39;</span>          <span class="p">:</span> <span class="mi">524</span><span class="p">,</span>  <span class="c"># short-range version of the PBE</span>
<span class="s">&#39;XC_GGA_X_HJSPBE&#39;</span>         <span class="p">:</span> <span class="mi">525</span><span class="p">,</span>  <span class="c"># HJS screened exchange PBE version</span>
<span class="s">&#39;XC_GGA_X_HJSPBESOL&#39;</span>      <span class="p">:</span> <span class="mi">526</span><span class="p">,</span>  <span class="c"># HJS screened exchange PBE_SOL version</span>
<span class="s">&#39;XC_GGA_X_HJSB88&#39;</span>         <span class="p">:</span> <span class="mi">527</span><span class="p">,</span>  <span class="c"># HJS screened exchange B88 version</span>
<span class="s">&#39;XC_GGA_X_HJSB97X&#39;</span>        <span class="p">:</span> <span class="mi">528</span><span class="p">,</span>  <span class="c"># HJS screened exchange B97x version</span>
<span class="s">&#39;XC_GGA_X_ITYH&#39;</span>           <span class="p">:</span> <span class="mi">529</span><span class="p">,</span>  <span class="c"># short-range recipe for exchange GGA functionals</span>
<span class="s">&#39;XC_GGA_X_SFAT&#39;</span>           <span class="p">:</span> <span class="mi">530</span><span class="p">,</span>  <span class="c"># short-range recipe for exchange GGA functionals</span>
<span class="s">&#39;XC_HYB_GGA_X_N12SX&#39;</span>      <span class="p">:</span>  <span class="mi">81</span><span class="p">,</span>  <span class="c"># N12-SX functional from Minnesota</span>
<span class="s">&#39;XC_HYB_GGA_XC_B3PW91&#39;</span>    <span class="p">:</span> <span class="mi">401</span><span class="p">,</span>  <span class="c"># The original hybrid proposed by Becke</span>
<span class="s">&#39;XC_HYB_GGA_XC_B3LYP&#39;</span>     <span class="p">:</span> <span class="mi">402</span><span class="p">,</span>  <span class="c"># The (in)famous B3LYP</span>
<span class="s">&#39;XC_HYB_GGA_XC_B3P86&#39;</span>     <span class="p">:</span> <span class="mi">403</span><span class="p">,</span>  <span class="c"># Perdew 86 hybrid similar to B3PW91</span>
<span class="s">&#39;XC_HYB_GGA_XC_O3LYP&#39;</span>     <span class="p">:</span> <span class="mi">404</span><span class="p">,</span>  <span class="c"># hybrid using the optx functional</span>
<span class="s">&#39;XC_HYB_GGA_XC_MPW1K&#39;</span>     <span class="p">:</span> <span class="mi">405</span><span class="p">,</span>  <span class="c"># mixture of mPW91 and PW91 optimized for kinetics</span>
<span class="s">&#39;XC_HYB_GGA_XC_PBEH&#39;</span>      <span class="p">:</span> <span class="mi">406</span><span class="p">,</span>  <span class="c"># aka PBE0 or PBE1PBE</span>
<span class="s">&#39;XC_HYB_GGA_XC_B97&#39;</span>       <span class="p">:</span> <span class="mi">407</span><span class="p">,</span>  <span class="c"># Becke 97</span>
<span class="s">&#39;XC_HYB_GGA_XC_B971&#39;</span>      <span class="p">:</span> <span class="mi">408</span><span class="p">,</span>  <span class="c"># Becke 97-1</span>
<span class="s">&#39;XC_HYB_GGA_XC_B972&#39;</span>      <span class="p">:</span> <span class="mi">410</span><span class="p">,</span>  <span class="c"># Becke 97-2</span>
<span class="s">&#39;XC_HYB_GGA_XC_X3LYP&#39;</span>     <span class="p">:</span> <span class="mi">411</span><span class="p">,</span>  <span class="c"># maybe the best hybrid</span>
<span class="s">&#39;XC_HYB_GGA_XC_B1WC&#39;</span>      <span class="p">:</span> <span class="mi">412</span><span class="p">,</span>  <span class="c"># Becke 1-parameter mixture of WC and PBE</span>
<span class="s">&#39;XC_HYB_GGA_XC_B97K&#39;</span>      <span class="p">:</span> <span class="mi">413</span><span class="p">,</span>  <span class="c"># Boese-Martin for Kinetics</span>
<span class="s">&#39;XC_HYB_GGA_XC_B973&#39;</span>      <span class="p">:</span> <span class="mi">414</span><span class="p">,</span>  <span class="c"># Becke 97-3</span>
<span class="s">&#39;XC_HYB_GGA_XC_MPW3PW&#39;</span>    <span class="p">:</span> <span class="mi">415</span><span class="p">,</span>  <span class="c"># mixture with the mPW functional</span>
<span class="s">&#39;XC_HYB_GGA_XC_B1LYP&#39;</span>     <span class="p">:</span> <span class="mi">416</span><span class="p">,</span>  <span class="c"># Becke 1-parameter mixture of B88 and LYP</span>
<span class="s">&#39;XC_HYB_GGA_XC_B1PW91&#39;</span>    <span class="p">:</span> <span class="mi">417</span><span class="p">,</span>  <span class="c"># Becke 1-parameter mixture of B88 and PW91</span>
<span class="s">&#39;XC_HYB_GGA_XC_MPW1PW&#39;</span>    <span class="p">:</span> <span class="mi">418</span><span class="p">,</span>  <span class="c"># Becke 1-parameter mixture of mPW91 and PW91</span>
<span class="s">&#39;XC_HYB_GGA_XC_MPW3LYP&#39;</span>   <span class="p">:</span> <span class="mi">419</span><span class="p">,</span>  <span class="c"># mixture of mPW and LYP</span>
<span class="s">&#39;XC_HYB_GGA_XC_SB981A&#39;</span>    <span class="p">:</span> <span class="mi">420</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 1a</span>
<span class="s">&#39;XC_HYB_GGA_XC_SB981B&#39;</span>    <span class="p">:</span> <span class="mi">421</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 1b</span>
<span class="s">&#39;XC_HYB_GGA_XC_SB981C&#39;</span>    <span class="p">:</span> <span class="mi">422</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 1c</span>
<span class="s">&#39;XC_HYB_GGA_XC_SB982A&#39;</span>    <span class="p">:</span> <span class="mi">423</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 2a</span>
<span class="s">&#39;XC_HYB_GGA_XC_SB982B&#39;</span>    <span class="p">:</span> <span class="mi">424</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 2b</span>
<span class="s">&#39;XC_HYB_GGA_XC_SB982C&#39;</span>    <span class="p">:</span> <span class="mi">425</span><span class="p">,</span>  <span class="c"># Schmider-Becke 98 parameterization 2c</span>
<span class="s">&#39;XC_HYB_GGA_X_SOGGA11X&#39;</span>   <span class="p">:</span> <span class="mi">426</span><span class="p">,</span>  <span class="c"># Hybrid based on SOGGA11 form</span>
<span class="s">&#39;XC_HYB_GGA_XC_HSE03&#39;</span>     <span class="p">:</span> <span class="mi">427</span><span class="p">,</span>  <span class="c"># the 2003 version of the screened hybrid HSE</span>
<span class="s">&#39;XC_HYB_GGA_XC_HSE06&#39;</span>     <span class="p">:</span> <span class="mi">428</span><span class="p">,</span>  <span class="c"># the 2006 version of the screened hybrid HSE</span>
<span class="s">&#39;XC_HYB_GGA_XC_HJSPBE&#39;</span>    <span class="p">:</span> <span class="mi">429</span><span class="p">,</span>  <span class="c"># HJS hybrid screened exchange PBE version</span>
<span class="s">&#39;XC_HYB_GGA_XC_HJSPBESOL&#39;</span> <span class="p">:</span> <span class="mi">430</span><span class="p">,</span>  <span class="c"># HJS hybrid screened exchange PBE_SOL version</span>
<span class="s">&#39;XC_HYB_GGA_XC_HJSB88&#39;</span>    <span class="p">:</span> <span class="mi">431</span><span class="p">,</span>  <span class="c"># HJS hybrid screened exchange B88 version</span>
<span class="s">&#39;XC_HYB_GGA_XC_HJSB97X&#39;</span>   <span class="p">:</span> <span class="mi">432</span><span class="p">,</span>  <span class="c"># HJS hybrid screened exchange B97x version</span>
<span class="s">&#39;XC_HYB_GGA_XC_CAMB3LYP&#39;</span>  <span class="p">:</span> <span class="mi">433</span><span class="p">,</span>  <span class="c"># CAM version of B3LYP</span>
<span class="s">&#39;XC_HYB_GGA_XC_TUNEDCAMB3LYP&#39;</span><span class="p">:</span> <span class="mi">434</span><span class="p">,</span> <span class="c"># CAM version of B3LYP tunes for excitations</span>
<span class="s">&#39;XC_HYB_GGA_XC_BHANDH&#39;</span>    <span class="p">:</span> <span class="mi">435</span><span class="p">,</span>  <span class="c"># Becke half-and-half</span>
<span class="s">&#39;XC_HYB_GGA_XC_BHANDHLYP&#39;</span> <span class="p">:</span> <span class="mi">436</span><span class="p">,</span>  <span class="c"># Becke half-and-half with B88 exchange</span>
<span class="s">&#39;XC_HYB_GGA_XC_MB3LYPRC04&#39;</span><span class="p">:</span> <span class="mi">437</span><span class="p">,</span>  <span class="c"># B3LYP with RC04 LDA</span>
<span class="s">&#39;XC_HYB_GGA_XC_MPWLYP1M&#39;</span>  <span class="p">:</span> <span class="mi">453</span><span class="p">,</span>  <span class="c"># MPW with 1 par. for metals/LYP</span>
<span class="s">&#39;XC_HYB_GGA_XC_REVB3LYP&#39;</span>  <span class="p">:</span> <span class="mi">454</span><span class="p">,</span>  <span class="c"># Revised B3LYP</span>
<span class="s">&#39;XC_HYB_GGA_XC_CAMYBLYP&#39;</span>  <span class="p">:</span> <span class="mi">455</span><span class="p">,</span>  <span class="c"># BLYP with yukawa screening</span>
<span class="s">&#39;XC_HYB_GGA_XC_PBE013&#39;</span>    <span class="p">:</span> <span class="mi">456</span><span class="p">,</span>  <span class="c"># PBE0-1/3</span>
<span class="s">&#39;XC_MGGA_XC_OTPSSD&#39;</span>       <span class="p">:</span>  <span class="mi">64</span><span class="p">,</span>  <span class="c"># oTPSS_D functional of Goerigk and Grimme</span>
<span class="s">&#39;XC_MGGA_C_CS&#39;</span>            <span class="p">:</span>  <span class="mi">72</span><span class="p">,</span>  <span class="c"># Colle and Salvetti</span>
<span class="s">&#39;XC_MGGA_C_MN12SX&#39;</span>        <span class="p">:</span>  <span class="mi">73</span><span class="p">,</span>  <span class="c"># MN12-SX functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_MN12L&#39;</span>         <span class="p">:</span>  <span class="mi">74</span><span class="p">,</span>  <span class="c"># MN12-L functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M11L&#39;</span>          <span class="p">:</span>  <span class="mi">75</span><span class="p">,</span>  <span class="c"># M11-L functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M11&#39;</span>           <span class="p">:</span>  <span class="mi">76</span><span class="p">,</span>  <span class="c"># M11 functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M08SO&#39;</span>         <span class="p">:</span>  <span class="mi">77</span><span class="p">,</span>  <span class="c"># M08-SO functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M08HX&#39;</span>         <span class="p">:</span>  <span class="mi">78</span><span class="p">,</span>  <span class="c"># M08-HX functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_LTA&#39;</span>           <span class="p">:</span> <span class="mi">201</span><span class="p">,</span>  <span class="c"># Local tau approximation of Ernzerhof &amp; Scuseria</span>
<span class="s">&#39;XC_MGGA_X_TPSS&#39;</span>          <span class="p">:</span> <span class="mi">202</span><span class="p">,</span>  <span class="c"># Perdew, Tao, Staroverov &amp; Scuseria exchange</span>
<span class="s">&#39;XC_MGGA_X_M06L&#39;</span>          <span class="p">:</span> <span class="mi">203</span><span class="p">,</span>  <span class="c"># M06-Local functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_GVT4&#39;</span>          <span class="p">:</span> <span class="mi">204</span><span class="p">,</span>  <span class="c"># GVT4 from Van Voorhis and Scuseria</span>
<span class="s">&#39;XC_MGGA_X_TAUHCTH&#39;</span>       <span class="p">:</span> <span class="mi">205</span><span class="p">,</span>  <span class="c"># tau-HCTH from Boese and Handy</span>
<span class="s">&#39;XC_MGGA_X_BR89&#39;</span>          <span class="p">:</span> <span class="mi">206</span><span class="p">,</span>  <span class="c"># Becke-Roussel 89</span>
<span class="s">&#39;XC_MGGA_X_BJ06&#39;</span>          <span class="p">:</span> <span class="mi">207</span><span class="p">,</span>  <span class="c"># Becke &amp; Johnson correction to Becke-Roussel 89</span>
<span class="s">&#39;XC_MGGA_X_TB09&#39;</span>          <span class="p">:</span> <span class="mi">208</span><span class="p">,</span>  <span class="c"># Tran &amp; Blaha correction to Becke &amp; Johnson</span>
<span class="s">&#39;XC_MGGA_X_RPP09&#39;</span>         <span class="p">:</span> <span class="mi">209</span><span class="p">,</span>  <span class="c"># Rasanen, Pittalis, and Proetto correction to Becke &amp; Johnson</span>
<span class="s">&#39;XC_MGGA_X_2DPRHG07&#39;</span>      <span class="p">:</span> <span class="mi">210</span><span class="p">,</span>  <span class="c"># Pittalis, Rasanen, Helbig, Gross Exchange Functional</span>
<span class="s">&#39;XC_MGGA_X_2DPRHG07PRP10&#39;</span> <span class="p">:</span> <span class="mi">211</span><span class="p">,</span>  <span class="c"># PRGH07 with PRP10 correction</span>
<span class="s">&#39;XC_MGGA_X_REVTPSS&#39;</span>       <span class="p">:</span> <span class="mi">212</span><span class="p">,</span>  <span class="c"># revised Perdew, Tao, Staroverov &amp; Scuseria exchange</span>
<span class="s">&#39;XC_MGGA_X_PKZB&#39;</span>          <span class="p">:</span> <span class="mi">213</span><span class="p">,</span>  <span class="c"># Perdew, Kurth, Zupan, and Blaha</span>
<span class="s">&#39;XC_MGGA_X_M05&#39;</span>           <span class="p">:</span> <span class="mi">214</span><span class="p">,</span>  <span class="c"># M05 functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_M052X&#39;</span>         <span class="p">:</span> <span class="mi">215</span><span class="p">,</span>  <span class="c"># M05-2X functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_M06HF&#39;</span>         <span class="p">:</span> <span class="mi">216</span><span class="p">,</span>  <span class="c"># M06-HF functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_M06&#39;</span>           <span class="p">:</span> <span class="mi">217</span><span class="p">,</span>  <span class="c"># M06 functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_M062X&#39;</span>         <span class="p">:</span> <span class="mi">218</span><span class="p">,</span>  <span class="c"># M06-2X functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_M08HX&#39;</span>         <span class="p">:</span> <span class="mi">219</span><span class="p">,</span>  <span class="c"># M08-HX functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_M08SO&#39;</span>         <span class="p">:</span> <span class="mi">220</span><span class="p">,</span>  <span class="c"># M08-SO functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_MS0&#39;</span>           <span class="p">:</span> <span class="mi">221</span><span class="p">,</span>  <span class="c"># MS exchange of Sun, Xiao, and Ruzsinszky</span>
<span class="s">&#39;XC_MGGA_X_MS1&#39;</span>           <span class="p">:</span> <span class="mi">222</span><span class="p">,</span>  <span class="c"># MS1 exchange of Sun, et al</span>
<span class="s">&#39;XC_MGGA_X_MS2&#39;</span>           <span class="p">:</span> <span class="mi">223</span><span class="p">,</span>  <span class="c"># MS2 exchange of Sun, et al</span>
<span class="s">&#39;XC_MGGA_X_MS2H&#39;</span>          <span class="p">:</span> <span class="mi">224</span><span class="p">,</span>  <span class="c"># MS2 hybrid exchange of Sun, et al</span>
<span class="s">&#39;XC_MGGA_X_M11L&#39;</span>          <span class="p">:</span> <span class="mi">226</span><span class="p">,</span>  <span class="c"># M11-L functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_X_MN12L&#39;</span>         <span class="p">:</span> <span class="mi">227</span><span class="p">,</span>  <span class="c"># MN12-L functional from Minnesota</span>
<span class="s">&#39;XC_MGGA_X_MN12SX&#39;</span>        <span class="p">:</span> <span class="mi">228</span><span class="p">,</span>  <span class="c"># MN12-SX functional from Minnesota</span>
<span class="s">&#39;XC_MGGA_C_CC06&#39;</span>          <span class="p">:</span> <span class="mi">229</span><span class="p">,</span>  <span class="c"># Cancio and Chou 2006</span>
<span class="s">&#39;XC_MGGA_X_MK00&#39;</span>          <span class="p">:</span> <span class="mi">230</span><span class="p">,</span>  <span class="c"># Exchange for accurate virtual orbital energies</span>
<span class="s">&#39;XC_MGGA_C_TPSS&#39;</span>          <span class="p">:</span> <span class="mi">231</span><span class="p">,</span>  <span class="c"># Perdew, Tao, Staroverov &amp; Scuseria correlation</span>
<span class="s">&#39;XC_MGGA_C_VSXC&#39;</span>          <span class="p">:</span> <span class="mi">232</span><span class="p">,</span>  <span class="c"># VSxc from Van Voorhis and Scuseria (correlation part)</span>
<span class="s">&#39;XC_MGGA_C_M06L&#39;</span>          <span class="p">:</span> <span class="mi">233</span><span class="p">,</span>  <span class="c"># M06-Local functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M06HF&#39;</span>         <span class="p">:</span> <span class="mi">234</span><span class="p">,</span>  <span class="c"># M06-HF functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M06&#39;</span>           <span class="p">:</span> <span class="mi">235</span><span class="p">,</span>  <span class="c"># M06 functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M062X&#39;</span>         <span class="p">:</span> <span class="mi">236</span><span class="p">,</span>  <span class="c"># M06-2X functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M05&#39;</span>           <span class="p">:</span> <span class="mi">237</span><span class="p">,</span>  <span class="c"># M05 functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_M052X&#39;</span>         <span class="p">:</span> <span class="mi">238</span><span class="p">,</span>  <span class="c"># M05-2X functional of Minnesota</span>
<span class="s">&#39;XC_MGGA_C_PKZB&#39;</span>          <span class="p">:</span> <span class="mi">239</span><span class="p">,</span>  <span class="c"># Perdew, Kurth, Zupan, and Blaha</span>
<span class="s">&#39;XC_MGGA_C_BC95&#39;</span>          <span class="p">:</span> <span class="mi">240</span><span class="p">,</span>  <span class="c"># Becke correlation 95</span>
<span class="s">&#39;XC_MGGA_C_REVTPSS&#39;</span>       <span class="p">:</span> <span class="mi">241</span><span class="p">,</span>  <span class="c"># revised TPSS correlation</span>
<span class="s">&#39;XC_MGGA_XC_TPSSLYP1W&#39;</span>    <span class="p">:</span> <span class="mi">242</span><span class="p">,</span>  <span class="c"># Functionals fitted for water</span>
<span class="s">&#39;XC_MGGA_X_MK00B&#39;</span>         <span class="p">:</span> <span class="mi">243</span><span class="p">,</span>  <span class="c"># Exchange for accurate virtual orbital energies (v. B)</span>
<span class="s">&#39;XC_MGGA_X_BLOC&#39;</span>          <span class="p">:</span> <span class="mi">244</span><span class="p">,</span>  <span class="c"># functional with balanced localization</span>
<span class="s">&#39;XC_MGGA_X_MODTPSS&#39;</span>       <span class="p">:</span> <span class="mi">245</span><span class="p">,</span>  <span class="c"># Modified Perdew, Tao, Staroverov &amp; Scuseria exchange</span>
<span class="s">&#39;XC_HYB_MGGA_X_M11&#39;</span>       <span class="p">:</span> <span class="mi">225</span><span class="p">,</span>  <span class="c"># M11 functional of Minnesota</span>
<span class="s">&#39;XC_HYB_MGGA_XC_M05&#39;</span>      <span class="p">:</span> <span class="mi">438</span><span class="p">,</span>  <span class="c"># M05 functional of Minnesota</span>
<span class="s">&#39;XC_HYB_MGGA_XC_M052X&#39;</span>    <span class="p">:</span> <span class="mi">439</span><span class="p">,</span>  <span class="c"># M05-2X functional of Minnesota</span>
<span class="s">&#39;XC_HYB_MGGA_XC_B88B95&#39;</span>   <span class="p">:</span> <span class="mi">440</span><span class="p">,</span>  <span class="c"># Mixture of B88 with BC95 (B1B95)</span>
<span class="s">&#39;XC_HYB_MGGA_XC_B86B95&#39;</span>   <span class="p">:</span> <span class="mi">441</span><span class="p">,</span>  <span class="c"># Mixture of B86 with BC95</span>
<span class="s">&#39;XC_HYB_MGGA_XC_PW86B95&#39;</span>  <span class="p">:</span> <span class="mi">442</span><span class="p">,</span>  <span class="c"># Mixture of PW86 with BC95</span>
<span class="s">&#39;XC_HYB_MGGA_XC_BB1K&#39;</span>     <span class="p">:</span> <span class="mi">443</span><span class="p">,</span>  <span class="c"># Mixture of B88 with BC95 from Zhao and Truhlar</span>
<span class="s">&#39;XC_HYB_MGGA_XC_M06HF&#39;</span>    <span class="p">:</span> <span class="mi">444</span><span class="p">,</span>  <span class="c"># M06-HF functional of Minnesota</span>
<span class="s">&#39;XC_HYB_MGGA_XC_MPW1B95&#39;</span>  <span class="p">:</span> <span class="mi">445</span><span class="p">,</span>  <span class="c"># Mixture of mPW91 with BC95 from Zhao and Truhlar</span>
<span class="s">&#39;XC_HYB_MGGA_XC_MPWB1K&#39;</span>   <span class="p">:</span> <span class="mi">446</span><span class="p">,</span>  <span class="c"># Mixture of mPW91 with BC95 for kinetics</span>
<span class="s">&#39;XC_HYB_MGGA_XC_X1B95&#39;</span>    <span class="p">:</span> <span class="mi">447</span><span class="p">,</span>  <span class="c"># Mixture of X with BC95</span>
<span class="s">&#39;XC_HYB_MGGA_XC_XB1K&#39;</span>     <span class="p">:</span> <span class="mi">448</span><span class="p">,</span>  <span class="c"># Mixture of X with BC95 for kinetics</span>
<span class="s">&#39;XC_HYB_MGGA_XC_M06&#39;</span>      <span class="p">:</span> <span class="mi">449</span><span class="p">,</span>  <span class="c"># M06 functional of Minnesota</span>
<span class="s">&#39;XC_HYB_MGGA_XC_M062X&#39;</span>    <span class="p">:</span> <span class="mi">450</span><span class="p">,</span>  <span class="c"># M06-2X functional of Minnesota</span>
<span class="s">&#39;XC_HYB_MGGA_XC_PW6B95&#39;</span>   <span class="p">:</span> <span class="mi">451</span><span class="p">,</span>  <span class="c"># Mixture of PW91 with BC95 from Zhao and Truhlar</span>
<span class="s">&#39;XC_HYB_MGGA_XC_PWB6K&#39;</span>    <span class="p">:</span> <span class="mi">452</span><span class="p">,</span>  <span class="c"># Mixture of PW91 with BC95 from Zhao and Truhlar for kinetics</span>
<span class="s">&#39;XC_HYB_MGGA_XC_TPSSH&#39;</span>    <span class="p">:</span> <span class="mi">457</span><span class="p">,</span>  <span class="c">#    TPSS hybrid</span>
<span class="s">&#39;XC_HYB_MGGA_XC_REVTPSSH&#39;</span> <span class="p">:</span> <span class="mi">458</span><span class="p">,</span>  <span class="c"># revTPSS hybrid</span>
<span class="c">#</span>
<span class="c"># alias</span>
<span class="c">#</span>
<span class="s">&#39;LDA&#39;</span>           <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span>
<span class="s">&#39;SLATER&#39;</span>        <span class="p">:</span> <span class="mi">1</span> <span class="p">,</span>
<span class="s">&#39;VWN5&#39;</span>          <span class="p">:</span> <span class="s">&#39;VWN&#39;</span> <span class="p">,</span>
<span class="s">&#39;BLYP&#39;</span>          <span class="p">:</span> <span class="s">&#39;B88,LYP&#39;</span><span class="p">,</span>
<span class="s">&#39;BP86&#39;</span>          <span class="p">:</span> <span class="s">&#39;B88,P86&#39;</span><span class="p">,</span>
<span class="s">&#39;PBE0&#39;</span>          <span class="p">:</span> <span class="mi">406</span><span class="p">,</span>
<span class="s">&#39;PBE1PBE&#39;</span>       <span class="p">:</span> <span class="mi">406</span><span class="p">,</span>
<span class="s">&#39;B3LYP&#39;</span>         <span class="p">:</span> <span class="s">&#39;B3LYP5&#39;</span><span class="p">,</span>  <span class="c"># VWN5 version</span>
<span class="s">&#39;B3LYP5&#39;</span>        <span class="p">:</span> <span class="s">&#39;.2*HF + .08*LDA + .72*B88, .81*LYP + .19*VWN&#39;</span><span class="p">,</span>
<span class="s">&#39;B3LYPG&#39;</span>        <span class="p">:</span> <span class="mi">402</span><span class="p">,</span>  <span class="c"># VWN3, used by Gaussian</span>
<span class="s">&#39;B3P86&#39;</span>         <span class="p">:</span> <span class="s">&#39;B3P865&#39;</span><span class="p">,</span>  <span class="c"># VWN5 version</span>
<span class="s">&#39;B3P865&#39;</span>        <span class="p">:</span> <span class="s">&#39;.2*HF + .08*LDA + .72*B88, .81*P86 + .19*VWN&#39;</span><span class="p">,</span>
<span class="s">&#39;B3P86G&#39;</span>        <span class="p">:</span> <span class="mi">403</span><span class="p">,</span>  <span class="c"># VWN3, used by Gaussian</span>
<span class="s">&#39;MPW3PW&#39;</span>        <span class="p">:</span> <span class="s">&#39;MPW3PW5&#39;</span><span class="p">,</span>  <span class="c"># VWN5 version</span>
<span class="s">&#39;MPW3PW5&#39;</span>       <span class="p">:</span> <span class="s">&#39;.2*HF + .08*LDA + .72*MPW91, .81*PW91 + .19*VWN&#39;</span><span class="p">,</span>
<span class="s">&#39;MPW3PWG&#39;</span>       <span class="p">:</span> <span class="mi">415</span><span class="p">,</span>  <span class="c"># VWN3, used by Gaussian</span>
<span class="s">&#39;MPW3LYP&#39;</span>       <span class="p">:</span> <span class="s">&#39;MPW3LYP5&#39;</span><span class="p">,</span>  <span class="c"># VWN5 version</span>
<span class="s">&#39;MPW3LYP5&#39;</span>      <span class="p">:</span> <span class="s">&#39;.218*HF + .073*LDA + .709*MPW91, .871*LYP + .129*VWN&#39;</span><span class="p">,</span>
<span class="s">&#39;MPW3LYPG&#39;</span>      <span class="p">:</span> <span class="mi">419</span><span class="p">,</span>  <span class="c"># VWN3, used by Gaussian</span>
<span class="s">&#39;REVB3LYP&#39;</span>      <span class="p">:</span> <span class="s">&#39;REVB3LYP5&#39;</span><span class="p">,</span>  <span class="c"># VWN5 version</span>
<span class="s">&#39;REVB3LYP5&#39;</span>     <span class="p">:</span> <span class="s">&#39;.2*HF + .13*LDA + .67*B88, .84*LYP + .16*VWN&#39;</span><span class="p">,</span>
<span class="s">&#39;REVB3LYPG&#39;</span>     <span class="p">:</span> <span class="mi">454</span><span class="p">,</span>  <span class="c"># VWN3, used by Gaussian</span>
<span class="s">&#39;X3LYP&#39;</span>         <span class="p">:</span> <span class="s">&#39;X3LYP5&#39;</span><span class="p">,</span>  <span class="c"># VWN5 version</span>
<span class="s">&#39;X3LYP5&#39;</span>        <span class="p">:</span> <span class="s">&#39;.218*HF + .073*LDA + .478575*B88 + .166615*PW91, .871*LYP + .129*VWN&#39;</span><span class="p">,</span>
<span class="s">&#39;X3LYPG&#39;</span>        <span class="p">:</span> <span class="mi">411</span><span class="p">,</span>  <span class="c"># VWN3, used by Gaussian</span>
<span class="p">}</span>

<span class="n">XC_KEYS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">XC_CODES</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">LDA_IDS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
               <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span>
               <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span>
               <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,))</span>
<span class="n">GGA_IDS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span> <span class="mi">47</span><span class="p">,</span>  <span class="mi">48</span><span class="p">,</span>  <span class="mi">49</span><span class="p">,</span>  <span class="mi">52</span><span class="p">,</span>  <span class="mi">53</span><span class="p">,</span>  <span class="mi">54</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span>  <span class="mi">56</span><span class="p">,</span>  <span class="mi">57</span><span class="p">,</span>  <span class="mi">58</span><span class="p">,</span>
                <span class="mi">59</span><span class="p">,</span>  <span class="mi">60</span><span class="p">,</span>  <span class="mi">61</span><span class="p">,</span>  <span class="mi">62</span><span class="p">,</span>  <span class="mi">63</span><span class="p">,</span>  <span class="mi">65</span><span class="p">,</span>  <span class="mi">66</span><span class="p">,</span>  <span class="mi">67</span><span class="p">,</span>  <span class="mi">68</span><span class="p">,</span>  <span class="mi">69</span><span class="p">,</span>
                <span class="mi">70</span><span class="p">,</span>  <span class="mi">71</span><span class="p">,</span>  <span class="mi">79</span><span class="p">,</span>  <span class="mi">80</span><span class="p">,</span>  <span class="mi">82</span><span class="p">,</span>  <span class="mi">83</span><span class="p">,</span>  <span class="mi">84</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span>  <span class="mi">86</span><span class="p">,</span>  <span class="mi">87</span><span class="p">,</span>
                <span class="mi">88</span><span class="p">,</span>  <span class="mi">89</span><span class="p">,</span>  <span class="mi">90</span><span class="p">,</span>  <span class="mi">91</span><span class="p">,</span>  <span class="mi">92</span><span class="p">,</span>  <span class="mi">93</span><span class="p">,</span>  <span class="mi">94</span><span class="p">,</span>  <span class="mi">95</span><span class="p">,</span>  <span class="mi">96</span><span class="p">,</span>  <span class="mi">97</span><span class="p">,</span>
                <span class="mi">98</span><span class="p">,</span>  <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span>
               <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span>
               <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span>
               <span class="mi">128</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span>
               <span class="mi">138</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span>
               <span class="mi">148</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span>
               <span class="mi">158</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span>
               <span class="mi">168</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">172</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span>
               <span class="mi">178</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span>
               <span class="mi">188</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span>
               <span class="mi">198</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">501</span><span class="p">,</span> <span class="mi">502</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">504</span><span class="p">,</span> <span class="mi">505</span><span class="p">,</span> <span class="mi">506</span><span class="p">,</span>
               <span class="mi">507</span><span class="p">,</span> <span class="mi">508</span><span class="p">,</span> <span class="mi">509</span><span class="p">,</span> <span class="mi">510</span><span class="p">,</span> <span class="mi">511</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">513</span><span class="p">,</span> <span class="mi">514</span><span class="p">,</span> <span class="mi">515</span><span class="p">,</span> <span class="mi">516</span><span class="p">,</span>
               <span class="mi">517</span><span class="p">,</span> <span class="mi">518</span><span class="p">,</span> <span class="mi">519</span><span class="p">,</span> <span class="mi">520</span><span class="p">,</span> <span class="mi">521</span><span class="p">,</span> <span class="mi">522</span><span class="p">,</span> <span class="mi">523</span><span class="p">,</span> <span class="mi">524</span><span class="p">,</span> <span class="mi">525</span><span class="p">,</span> <span class="mi">526</span><span class="p">,</span>
               <span class="mi">527</span><span class="p">,</span> <span class="mi">528</span><span class="p">,</span> <span class="mi">529</span><span class="p">,</span> <span class="mi">530</span><span class="p">,</span>
                <span class="mi">81</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">402</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">404</span><span class="p">,</span> <span class="mi">405</span><span class="p">,</span> <span class="mi">406</span><span class="p">,</span> <span class="mi">407</span><span class="p">,</span> <span class="mi">408</span><span class="p">,</span> <span class="mi">410</span><span class="p">,</span>
               <span class="mi">411</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">413</span><span class="p">,</span> <span class="mi">414</span><span class="p">,</span> <span class="mi">415</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">417</span><span class="p">,</span> <span class="mi">418</span><span class="p">,</span> <span class="mi">419</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span>
               <span class="mi">421</span><span class="p">,</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">423</span><span class="p">,</span> <span class="mi">424</span><span class="p">,</span> <span class="mi">425</span><span class="p">,</span> <span class="mi">426</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">428</span><span class="p">,</span> <span class="mi">429</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span>
               <span class="mi">431</span><span class="p">,</span> <span class="mi">432</span><span class="p">,</span> <span class="mi">433</span><span class="p">,</span> <span class="mi">434</span><span class="p">,</span> <span class="mi">435</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">437</span><span class="p">,</span> <span class="mi">453</span><span class="p">,</span> <span class="mi">454</span><span class="p">,</span> <span class="mi">455</span><span class="p">,</span>
               <span class="mi">456</span><span class="p">,))</span>
<span class="n">MGGA_IDS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span> <span class="mi">64</span><span class="p">,</span>  <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span>  <span class="mi">74</span><span class="p">,</span>  <span class="mi">75</span><span class="p">,</span>  <span class="mi">76</span><span class="p">,</span>  <span class="mi">77</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span>  <span class="mi">201</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span>
                <span class="mi">203</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">206</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span>
                <span class="mi">213</span><span class="p">,</span> <span class="mi">214</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span>
                <span class="mi">223</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span>
                <span class="mi">234</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span>
                <span class="mi">244</span><span class="p">,</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">438</span><span class="p">,</span> <span class="mi">439</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">442</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">444</span><span class="p">,</span>
                <span class="mi">445</span><span class="p">,</span> <span class="mi">446</span><span class="p">,</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">448</span><span class="p">,</span> <span class="mi">449</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">451</span><span class="p">,</span> <span class="mi">452</span><span class="p">,</span> <span class="mi">457</span><span class="p">,</span> <span class="mi">458</span><span class="p">,))</span>
<span class="n">HYB_IDS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">401</span><span class="p">,</span> <span class="mi">402</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">404</span><span class="p">,</span> <span class="mi">405</span><span class="p">,</span> <span class="mi">406</span><span class="p">,</span> <span class="mi">407</span><span class="p">,</span> <span class="mi">408</span><span class="p">,</span> <span class="mi">410</span><span class="p">,</span> <span class="mi">411</span><span class="p">,</span>
               <span class="mi">412</span><span class="p">,</span> <span class="mi">413</span><span class="p">,</span> <span class="mi">414</span><span class="p">,</span> <span class="mi">415</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">417</span><span class="p">,</span> <span class="mi">418</span><span class="p">,</span> <span class="mi">419</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">421</span><span class="p">,</span>
               <span class="mi">422</span><span class="p">,</span> <span class="mi">423</span><span class="p">,</span> <span class="mi">424</span><span class="p">,</span> <span class="mi">425</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">428</span><span class="p">,</span> <span class="mi">429</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">431</span><span class="p">,</span> <span class="mi">432</span><span class="p">,</span>
               <span class="mi">433</span><span class="p">,</span> <span class="mi">433</span><span class="p">,</span> <span class="mi">433</span><span class="p">,</span> <span class="mi">434</span><span class="p">,</span> <span class="mi">435</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">437</span><span class="p">,</span> <span class="mi">453</span><span class="p">,</span> <span class="mi">454</span><span class="p">,</span> <span class="mi">455</span><span class="p">,</span>
               <span class="mi">456</span><span class="p">,</span>
               <span class="mi">438</span><span class="p">,</span> <span class="mi">439</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">442</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">444</span><span class="p">,</span> <span class="mi">445</span><span class="p">,</span> <span class="mi">446</span><span class="p">,</span> <span class="mi">447</span><span class="p">,</span>
               <span class="mi">448</span><span class="p">,</span> <span class="mi">449</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">451</span><span class="p">,</span> <span class="mi">452</span><span class="p">,</span> <span class="mi">457</span><span class="p">,</span> <span class="mi">458</span><span class="p">,))</span>

<span class="n">X_AND_C_IDS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">65</span><span class="p">,</span>  <span class="mi">66</span><span class="p">,</span>  <span class="mi">67</span><span class="p">,</span>  <span class="mi">93</span><span class="p">,</span>  <span class="mi">94</span><span class="p">,</span>  <span class="mi">95</span><span class="p">,</span>  <span class="mi">96</span><span class="p">,</span>  <span class="mi">97</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span>
                   <span class="mi">154</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span>
                   <span class="mi">167</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">172</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span>
                   <span class="mi">177</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span>
                   <span class="mi">199</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">402</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">404</span><span class="p">,</span> <span class="mi">405</span><span class="p">,</span> <span class="mi">406</span><span class="p">,</span> <span class="mi">407</span><span class="p">,</span> <span class="mi">408</span><span class="p">,</span> <span class="mi">410</span><span class="p">,</span>
                   <span class="mi">411</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">413</span><span class="p">,</span> <span class="mi">414</span><span class="p">,</span> <span class="mi">415</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">417</span><span class="p">,</span> <span class="mi">418</span><span class="p">,</span> <span class="mi">419</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span>
                   <span class="mi">421</span><span class="p">,</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">423</span><span class="p">,</span> <span class="mi">424</span><span class="p">,</span> <span class="mi">425</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">428</span><span class="p">,</span> <span class="mi">429</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">431</span><span class="p">,</span>
                   <span class="mi">432</span><span class="p">,</span> <span class="mi">433</span><span class="p">,</span> <span class="mi">434</span><span class="p">,</span> <span class="mi">435</span><span class="p">,</span> <span class="mi">436</span><span class="p">,</span> <span class="mi">437</span><span class="p">,</span> <span class="mi">453</span><span class="p">,</span> <span class="mi">454</span><span class="p">,</span> <span class="mi">455</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span>
                    <span class="mi">64</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">438</span><span class="p">,</span> <span class="mi">439</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">442</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">444</span><span class="p">,</span> <span class="mi">445</span><span class="p">,</span>
                   <span class="mi">446</span><span class="p">,</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">448</span><span class="p">,</span> <span class="mi">449</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">451</span><span class="p">,</span> <span class="mi">452</span><span class="p">,</span> <span class="mi">457</span><span class="p">,</span> <span class="mi">458</span><span class="p">,))</span>

<span class="k">def</span> <span class="nf">is_lda</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xc_code</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span> <span class="ow">in</span> <span class="n">LDA_IDS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">all</span><span class="p">((</span><span class="n">xid</span> <span class="ow">in</span> <span class="n">LDA_IDS</span> <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xc_code</span> <span class="ow">in</span> <span class="n">LDA_IDS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">((</span><span class="n">is_lda</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xc_code</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">is_hybrid_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xc_code</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span> <span class="ow">in</span> <span class="n">HYB_IDS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s">&#39;HF&#39;</span> <span class="ow">in</span> <span class="n">xc_code</span> <span class="ow">or</span>
                    <span class="nb">any</span><span class="p">((</span><span class="n">xid</span> <span class="ow">in</span> <span class="n">HYB_IDS</span> <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span> <span class="ow">or</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">1e-14</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xc_code</span> <span class="ow">in</span> <span class="n">HYB_IDS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">((</span><span class="n">is_hybrid_xc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xc_code</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">is_meta_gga</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xc_code</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span> <span class="ow">in</span> <span class="n">MGGA_IDS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">any</span><span class="p">((</span><span class="n">xid</span> <span class="ow">in</span> <span class="n">MGGA_IDS</span> <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xc_code</span> <span class="ow">in</span> <span class="n">MGGA_IDS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">((</span><span class="n">is_meta_gga</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xc_code</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">is_gga</span><span class="p">(</span><span class="n">xc_code</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xc_code</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="n">xc_code</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">xc_code</span> <span class="ow">in</span> <span class="n">GGA_IDS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xc_fns</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">all</span><span class="p">((</span><span class="n">xid</span> <span class="ow">in</span> <span class="n">GGA_IDS</span> <span class="ow">or</span> <span class="n">xid</span> <span class="ow">in</span> <span class="n">LDA_IDS</span> <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">xc_fns</span><span class="p">))</span> <span class="ow">and</span>
                    <span class="ow">not</span> <span class="n">is_lda</span><span class="p">(</span><span class="n">xc_code</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">xc_code</span> <span class="ow">in</span> <span class="n">GGA_IDS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">all</span><span class="p">((</span><span class="n">is_gga</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_lda</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xc_code</span><span class="p">))</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="n">is_lda</span><span class="p">(</span><span class="n">xc_code</span><span class="p">))</span>

<div class="viewcode-block" id="hybrid_coeff"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.hybrid_coeff">[docs]</a><span class="k">def</span> <span class="nf">hybrid_coeff</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Support recursively defining hybrid functional</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">hyb</span><span class="p">,</span> <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">xid</span><span class="p">,</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xid</span> <span class="ow">in</span> <span class="n">HYB_IDS</span><span class="p">:</span>
            <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_hybrid_coeff</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span>
            <span class="n">hyb</span> <span class="o">+=</span> <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_hybrid_coeff</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">xid</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">spin</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hyb</span>
</div>
<div class="viewcode-block" id="parse_xc_name"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.parse_xc_name">[docs]</a><span class="k">def</span> <span class="nf">parse_xc_name</span><span class="p">(</span><span class="n">xc_name</span><span class="o">=</span><span class="s">&#39;LDA,VWN&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Convert the XC functional name to libxc library internal ID.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_name</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">fn_facs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fn_facs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="parse_xc"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.parse_xc">[docs]</a><span class="k">def</span> <span class="nf">parse_xc</span><span class="p">(</span><span class="n">description</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Rules to input functional description:</span>

<span class="sd">    * The given functional description must be a one-line string.</span>
<span class="sd">    * The functional description is case-insensitive.</span>
<span class="sd">    * The functional description string has two parts, separated by &quot;,&quot;.  The</span>
<span class="sd">      first part describes the exchange functional, the second is the correlation</span>
<span class="sd">      functional.</span>

<span class="sd">      - If &quot;,&quot; not appeared in string, the entire string is considered as X functional.</span>
<span class="sd">      - To neglect X functional (just apply C functional), leave blank in the</span>
<span class="sd">        first part, eg description=&#39;,vwn&#39; for pure VWN functional</span>

<span class="sd">    * The functional name can be placed in arbitrary order.  Two name needs to</span>
<span class="sd">      be separated by operators &quot;+&quot; or &quot;-&quot;.  Blank spaces are ignored.</span>
<span class="sd">      NOTE the parser only reads operators &quot;+&quot; &quot;-&quot; &quot;*&quot;.  / is not in support.</span>
<span class="sd">    * A functional name is associated with one factor.  If the factor is not</span>
<span class="sd">      given, it is assumed equaling 1.</span>
<span class="sd">    * String &quot;HF&quot; stands for exact exchange (HF K matrix).  It is allowed to</span>
<span class="sd">      put in C functional part.</span>
<span class="sd">    * Be careful with the libxc convention on GGA functional, in which the LDA</span>
<span class="sd">      contribution is included.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="n">description</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="c">#isinstance(description, (tuple,list)):</span>
        <span class="k">return</span> <span class="n">parse_xc</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">description</span><span class="p">))</span>

    <span class="k">if</span> <span class="s">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">x_code</span><span class="p">,</span> <span class="n">c_code</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_code</span><span class="p">,</span> <span class="n">c_code</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="s">&#39;&#39;</span>

    <span class="n">hyb</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fn_facs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">parse_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">possible_xc_for</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">token</span><span class="p">:</span>
                <span class="n">fac</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;*&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                    <span class="n">fac</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">,</span> <span class="n">fac</span>
                <span class="n">fac</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">fac</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">token</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&#39;HF&#39;</span><span class="p">:</span>
                <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fac</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">XC_CODES</span><span class="p">:</span>
                    <span class="n">x_id</span> <span class="o">=</span> <span class="n">XC_CODES</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">possible_xc</span> <span class="o">=</span> <span class="n">XC_KEYS</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">possible_xc_for</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">possible_xc</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_xc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;Possible xc_code </span><span class="si">%s</span><span class="s"> matches </span><span class="si">%s</span><span class="s">. &#39;</span>
                                             <span class="o">%</span> <span class="p">(</span><span class="n">possible_xc</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                            <span class="n">x_id</span> <span class="o">=</span> <span class="n">possible_xc</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;Take </span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">x_id</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">x_id</span> <span class="o">=</span> <span class="n">possible_xc</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                        <span class="n">x_id</span> <span class="o">=</span> <span class="n">XC_CODES</span><span class="p">[</span><span class="n">x_id</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&#39;Unknown key </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">hyb1</span><span class="p">,</span> <span class="n">acc1</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">x_id</span><span class="p">)</span>
                    <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">hyb1</span>
                    <span class="n">fn_facs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">acc1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">x_id</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fn_facs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x_id</span><span class="p">,</span> <span class="n">fac</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">possible_x_for</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">((</span><span class="s">&#39;XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s">&#39;XC_LDA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_GGA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_MGGA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s">&#39;XC_LDA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_GGA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_MGGA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s">&#39;XC_HYB_GGA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_HYB_MGGA_X_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s">&#39;XC_HYB_GGA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_HYB_MGGA_XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">possible_k_for</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">((</span><span class="s">&#39;XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s">&#39;XC_LDA_K_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_GGA_K_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,))</span>
    <span class="k">def</span> <span class="nf">possible_c_for</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">((</span><span class="s">&#39;XC_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
                    <span class="s">&#39;XC_LDA_C_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_GGA_C_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="s">&#39;XC_MGGA_C_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">remove_dup</span><span class="p">(</span><span class="n">fn_facs</span><span class="p">):</span>
        <span class="n">fn_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">facs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fn_ids</span><span class="p">:</span>
                <span class="n">facs</span><span class="p">[</span><span class="n">fn_ids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fn_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">facs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fn_ids</span><span class="p">,</span> <span class="n">facs</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">x_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="s">&#39;+-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">):</span>
        <span class="n">parse_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">possible_x_for</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">c_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="s">&#39;+-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">):</span>
        <span class="n">parse_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">possible_c_for</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hyb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">remove_dup</span><span class="p">(</span><span class="n">fn_facs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="eval_xc"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.eval_xc">[docs]</a><span class="k">def</span> <span class="nf">eval_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relativity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;Interface to call xcfun library to evaluate XC functional, potential</span>
<span class="sd">    and functional derivatives.</span>

<span class="sd">    * The given functional xc_code must be a one-line string.</span>
<span class="sd">    * The functional xc_code is case-insensitive.</span>
<span class="sd">    * The functional xc_code string has two parts, separated by &quot;,&quot;.  The</span>
<span class="sd">      first part describes the exchange functional, the second is the correlation</span>
<span class="sd">      functional.</span>

<span class="sd">      - If &quot;,&quot; not appeared in string, the entire string is considered as X functional.</span>
<span class="sd">      - To neglect X functional (just apply C functional), leave blank in the</span>
<span class="sd">        first part, eg description=&#39;,vwn&#39; for pure VWN functional</span>

<span class="sd">    * The functional name can be placed in arbitrary order.  Two name needs to</span>
<span class="sd">      be separated by operators &quot;+&quot; or &quot;-&quot;.  Blank spaces are ignored.</span>
<span class="sd">      NOTE the parser only reads operators &quot;+&quot; &quot;-&quot; &quot;*&quot;.  / is not in support.</span>
<span class="sd">    * A functional name is associated with one factor.  If the factor is not</span>
<span class="sd">      given, it is assumed equaling 1.</span>
<span class="sd">    * String &quot;HF&quot; stands for exact exchange (HF K matrix).  It is allowed to</span>
<span class="sd">      put in C functional part.</span>
<span class="sd">    * Be careful with the libxc convention on GGA functional, in which the LDA</span>
<span class="sd">      contribution is included.</span>

<span class="sd">    Args:</span>
<span class="sd">        xc_code : str</span>
<span class="sd">            A string to describe the linear combination of different XC functionals.</span>
<span class="sd">            The X and C functional are separated by comma like &#39;.8*LDA+.2*B86,VWN&#39;.</span>
<span class="sd">            If &quot;HF&quot; was appeared in the string, it stands for the exact exchange.</span>
<span class="sd">        rho : ndarray</span>
<span class="sd">            Shape of ((*,N)) for electron density (and derivatives) if spin = 0;</span>
<span class="sd">            Shape of ((*,N),(*,N)) for alpha/beta electron density (and derivatives) if spin &gt; 0;</span>
<span class="sd">            where N is number of grids.</span>
<span class="sd">            rho (*,N) are ordered as (den,grad_x,grad_y,grad_z,laplacian,tau)</span>
<span class="sd">            where grad_x = d/dx den, laplacian = \nabla^2 den, tau = 1/2(\nabla f)^2</span>
<span class="sd">            In spin unrestricted case,</span>
<span class="sd">            rho is ((den_u,grad_xu,grad_yu,grad_zu,laplacian_u,tau_u)</span>
<span class="sd">                    (den_d,grad_xd,grad_yd,grad_zd,laplacian_d,tau_d))</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        spin : int</span>
<span class="sd">            spin polarized if spin &gt; 0</span>
<span class="sd">        relativity : int</span>
<span class="sd">            No effects.</span>
<span class="sd">        verbose : int or object of :class:`Logger`</span>
<span class="sd">            No effects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ex, vxc, fxc, kxc</span>

<span class="sd">        where</span>

<span class="sd">        * vxc = (vrho, vsigma, vlapl, vtau) for restricted case</span>

<span class="sd">        * vxc for unrestricted case</span>
<span class="sd">          | vrho[:,2]   = (u, d)</span>
<span class="sd">          | vsigma[:,3] = (uu, ud, dd)</span>
<span class="sd">          | vlapl[:,2]  = (u, d)</span>
<span class="sd">          | vtau[:,2]   = (u, d)</span>

<span class="sd">        * fxc for restricted case:</span>
<span class="sd">          (v2rho2, v2rhosigma, v2sigma2, v2lapl2, vtau2, v2rholapl, v2rhotau, v2lapltau, v2sigmalapl, v2sigmatau)</span>

<span class="sd">        * fxc for unrestricted case:</span>
<span class="sd">          | v2rho2[:,3]     = (u_u, u_d, d_d)</span>
<span class="sd">          | v2rhosigma[:,6] = (u_uu, u_ud, u_dd, d_uu, d_ud, d_dd)</span>
<span class="sd">          | v2sigma2[:,6]   = (uu_uu, uu_ud, uu_dd, ud_ud, ud_dd, dd_dd)</span>
<span class="sd">          | v2lapl2[:,3]</span>
<span class="sd">          | vtau2[:,3]</span>
<span class="sd">          | v2rholapl[:,4]</span>
<span class="sd">          | v2rhotau[:,4]</span>
<span class="sd">          | v2lapltau[:,4]</span>
<span class="sd">          | v2sigmalapl[:,6]</span>
<span class="sd">          | v2sigmatau[:,6]</span>

<span class="sd">        * kxc for restricted case:</span>
<span class="sd">          (v3rho3, v3rho2sigma, v3rhosigma2, v3sigma)</span>

<span class="sd">        * kxc for unrestricted case:</span>
<span class="sd">          | v3rho3[:,4]       = (u_u_u, u_u_d, u_d_d, d_d_d)</span>
<span class="sd">          | v3rho2sigma[:,9]  = (u_u_uu, u_u_ud, u_u_dd, u_d_uu, u_d_ud, u_d_dd, d_d_uu, d_d_ud, d_d_dd)</span>
<span class="sd">          | v3rhosigma2[:,12] = (u_uu_uu, u_uu_ud, u_uu_dd, u_ud_ud, u_ud_dd, u_dd_dd, d_uu_uu, d_uu_ud, d_uu_dd, d_ud_ud, d_ud_dd, d_dd_dd)</span>
<span class="sd">          | v3sigma[:,10]     = (uu_uu_uu, uu_uu_ud, uu_uu_dd, uu_ud_ud, uu_ud_dd, uu_dd_dd, ud_ud_ud, ud_ud_dd, ud_dd_dd, dd_dd_dd)</span>

<span class="sd">        see also libxc_itrf.c</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">hyb</span><span class="p">,</span> <span class="n">fn_facs</span> <span class="o">=</span> <span class="n">parse_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_eval_xc</span><span class="p">(</span><span class="n">fn_facs</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">spin</span><span class="p">,</span> <span class="n">relativity</span><span class="p">,</span> <span class="n">deriv</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>

</div>
<span class="n">SINGULAR_IDS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">131</span><span class="p">,</span>  <span class="c"># LYP functions</span>
                    <span class="mi">402</span><span class="p">,</span> <span class="mi">404</span><span class="p">,</span> <span class="mi">411</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">419</span><span class="p">))</span>  <span class="c"># hybrid LYP functions</span>
<span class="k">def</span> <span class="nf">_eval_xc</span><span class="p">(</span><span class="n">fn_facs</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relativity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">deriv</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">nspin</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">rho_u</span> <span class="o">=</span> <span class="n">rho_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nspin</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">rho_u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span>
        <span class="n">rho_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rho_u</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rho_u</span> <span class="o">=</span> <span class="n">rho_u</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">rho_d</span> <span class="o">=</span> <span class="n">rho_d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ngrids</span> <span class="o">=</span> <span class="n">rho_u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">fn_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">]</span>
    <span class="n">facs</span>   <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fn_facs</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">((</span><span class="n">is_lda</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fn_ids</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">((</span><span class="n">is_meta_gga</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fn_ids</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c"># GGA</span>
        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nvar</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">outlen</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">nvar</span><span class="o">+</span><span class="n">deriv</span><span class="p">)</span> <span class="o">//</span>
              <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">nvar</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">deriv</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">SINGULAR_IDS</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">fn_ids</span><span class="p">)</span> <span class="ow">and</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">non0idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho_u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">5e-11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rho_d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">5e-11</span><span class="p">)</span>
        <span class="n">rho_u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho_u</span><span class="p">[:,</span><span class="n">non0idx</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span>
        <span class="n">rho_d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rho_d</span><span class="p">[:,</span><span class="n">non0idx</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span>
        <span class="n">outbuf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">outlen</span><span class="p">,</span><span class="n">non0idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">outbuf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">outlen</span><span class="p">,</span><span class="n">ngrids</span><span class="p">))</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fn_ids</span><span class="p">)</span>
    <span class="n">_itrf</span><span class="o">.</span><span class="n">LIBXC_eval_xc</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="o">*</span><span class="n">n</span><span class="p">)(</span><span class="o">*</span><span class="n">fn_ids</span><span class="p">),</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="o">*</span><span class="n">n</span><span class="p">)(</span><span class="o">*</span><span class="n">facs</span><span class="p">),</span>
                        <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nspin</span><span class="p">),</span>
                        <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">deriv</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">rho_u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="n">rho_u</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
                        <span class="n">rho_d</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
                        <span class="n">outbuf</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">outbuf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ngrids</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">outlen</span><span class="p">,</span><span class="n">ngrids</span><span class="p">))</span>
        <span class="n">out</span><span class="p">[:,</span><span class="n">non0idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">outbuf</span>
        <span class="n">outbuf</span> <span class="o">=</span> <span class="n">out</span>

    <span class="n">exc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">vxc</span> <span class="o">=</span> <span class="n">fxc</span> <span class="o">=</span> <span class="n">kxc</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># LDA</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">2</span><span class="p">],)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">None</span><span class="p">,)</span><span class="o">*</span><span class="mi">9</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">kxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c"># GGA</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">5</span><span class="p">],)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">None</span><span class="p">,)</span><span class="o">*</span><span class="mi">7</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">kxc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># LDA</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">None</span><span class="p">,)</span><span class="o">*</span><span class="mi">9</span>
            <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">kxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>  <span class="c"># GGA</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">15</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">None</span><span class="p">,)</span><span class="o">*</span><span class="mi">7</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">kxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">21</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">34</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c"># MGGA</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vxc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fxc</span> <span class="o">=</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">nvar</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>  <span class="c"># MGGA</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">outbuf</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                   <span class="n">outbuf</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">28</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">35</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                   <span class="n">outbuf</span><span class="p">[</span><span class="mi">35</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">39</span><span class="p">:</span><span class="mi">43</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">43</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                   <span class="n">outbuf</span><span class="p">[</span><span class="mi">49</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span><span class="p">,</span> <span class="n">fxc</span><span class="p">,</span> <span class="n">kxc</span>


<div class="viewcode-block" id="define_xc_"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.define_xc_">[docs]</a><span class="k">def</span> <span class="nf">define_xc_</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Define XC functional.  See also :func:`eval_xc` for the rules of input description.</span>

<span class="sd">    Args:</span>
<span class="sd">        ni : an instance of :class:`_NumInt`</span>

<span class="sd">        description : str</span>
<span class="sd">            A string to describe the linear combination of different XC functionals.</span>
<span class="sd">            The X and C functional are separated by comma like &#39;.8*LDA+.2*B86,VWN&#39;.</span>
<span class="sd">            If &quot;HF&quot; was appeared in the string, it stands for the exact exchange.</span>

<span class="sd">    Examples:</span>

<span class="sd">    &gt;&gt;&gt; mol = gto.M(atom=&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;, basis=&#39;ccpvdz&#39;)</span>
<span class="sd">    &gt;&gt;&gt; mf = dft.RKS(mol)</span>
<span class="sd">    &gt;&gt;&gt; define_xc_(mf._numint, &#39;.2*HF + .08*LDA + .72*B88, .81*LYP + .19*VWN&#39;)</span>
<span class="sd">    &gt;&gt;&gt; mf.kernel()</span>
<span class="sd">    -76.3783361189611</span>
<span class="sd">    &gt;&gt;&gt; define_xc_(mf._numint, &#39;LDA*.08 + .72*B88 + .2*HF, .81*LYP + .19*VWN&#39;)</span>
<span class="sd">    &gt;&gt;&gt; mf.kernel()</span>
<span class="sd">    -76.3783361189611</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ni</span><span class="o">.</span><span class="n">eval_xc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xc_code</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relativity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">None</span><span class="p">:</span> \
            <span class="n">eval_xc</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">spin</span><span class="p">,</span> <span class="n">relativity</span><span class="p">,</span> <span class="n">deriv</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
    <span class="n">ni</span><span class="o">.</span><span class="n">hybrid_coeff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">hybrid_coeff</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">xc_type</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_lda</span><span class="p">(</span><span class="n">description</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&#39;LDA&#39;</span>
        <span class="k">elif</span> <span class="n">is_meta_gga</span><span class="p">(</span><span class="n">description</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;meta-GGA&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;GGA&#39;</span>
    <span class="n">ni</span><span class="o">.</span><span class="n">_xc_type</span> <span class="o">=</span> <span class="n">xc_type</span>
    <span class="k">return</span> <span class="n">ni</span>
</div>
<div class="viewcode-block" id="define_xc"><a class="viewcode-back" href="../../../dft.html#pyscf.dft.libxc.define_xc">[docs]</a><span class="k">def</span> <span class="nf">define_xc</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">define_xc_</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ni</span><span class="p">),</span> <span class="n">description</span><span class="p">)</span></div>
<span class="n">define_xc</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="n">define_xc_</span><span class="o">.</span><span class="n">__doc__</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">&quot;O&quot;</span> <span class="p">,</span> <span class="p">(</span><span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span>     <span class="p">,</span> <span class="mf">0.</span><span class="p">)],</span>
        <span class="p">[</span><span class="mi">1</span>   <span class="p">,</span> <span class="p">(</span><span class="mf">0.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.757</span> <span class="p">,</span> <span class="mf">0.587</span><span class="p">)],</span>
        <span class="p">[</span><span class="mi">1</span>   <span class="p">,</span> <span class="p">(</span><span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.757</span>  <span class="p">,</span> <span class="mf">0.587</span><span class="p">)]</span> <span class="p">],</span>
        <span class="n">basis</span> <span class="o">=</span> <span class="s">&#39;6311g*&#39;</span><span class="p">,)</span>
    <span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s">&#39;b88,lyp&#39;</span>
    <span class="n">eref</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

    <span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">_numint</span> <span class="o">=</span> <span class="n">define_xc</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s">&#39;BLYP&#39;</span><span class="p">)</span>
    <span class="n">e1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">e1</span> <span class="o">-</span> <span class="n">eref</span><span class="p">)</span>

    <span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">_numint</span> <span class="o">=</span> <span class="n">define_xc</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s">&#39;B3LYP5&#39;</span><span class="p">)</span>
    <span class="n">e1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">e1</span> <span class="o">-</span> <span class="o">-</span><span class="mf">76.4102840115744</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">PySCF 1.1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015-, Qiming Sun &lt;osirpt.sun@gmail.com&gt;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>